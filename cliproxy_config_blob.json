{"sha":"5af74b1b416cc7ed2569a7d7d37c704560e3c7bf","node_id":"B_kwDOPFM7E9oAKDVhZjc0YjFiNDE2Y2M3ZWQyNTY5YTdkN2QzN2M3MDQ1NjBlM2M3YmY","size":44554,"url":"https://api.github.com/repos/router-for-me/CLIProxyAPI/git/blobs/5af74b1b416cc7ed2569a7d7d37c704560e3c7bf","content":"Ly8gUGFja2FnZSBjb25maWcgcHJvdmlkZXMgY29uZmlndXJhdGlvbiBtYW5h\nZ2VtZW50IGZvciB0aGUgQ0xJIFByb3h5IEFQSSBzZXJ2ZXIuCi8vIEl0IGhh\nbmRsZXMgbG9hZGluZyBhbmQgcGFyc2luZyBZQU1MIGNvbmZpZ3VyYXRpb24g\nZmlsZXMsIGFuZCBwcm92aWRlcyBzdHJ1Y3R1cmVkCi8vIGFjY2VzcyB0byBh\ncHBsaWNhdGlvbiBzZXR0aW5ncyBpbmNsdWRpbmcgc2VydmVyIHBvcnQsIGF1\ndGhlbnRpY2F0aW9uIGRpcmVjdG9yeSwKLy8gZGVidWcgc2V0dGluZ3MsIHBy\nb3h5IGNvbmZpZ3VyYXRpb24sIGFuZCBBUEkga2V5cy4KcGFja2FnZSBjb25m\naWcKCmltcG9ydCAoCgkiYnl0ZXMiCgkiZXJyb3JzIgoJImZtdCIKCSJvcyIK\nCSJzdHJpbmdzIgoJInN5c2NhbGwiCgoJImdpdGh1Yi5jb20vcm91dGVyLWZv\nci1tZS9DTElQcm94eUFQSS92Ni9zZGsvY29uZmlnIgoJImdvbGFuZy5vcmcv\neC9jcnlwdG8vYmNyeXB0IgoJImdvcGtnLmluL3lhbWwudjMiCikKCi8vIENv\nbmZpZyByZXByZXNlbnRzIHRoZSBhcHBsaWNhdGlvbidzIGNvbmZpZ3VyYXRp\nb24sIGxvYWRlZCBmcm9tIGEgWUFNTCBmaWxlLgp0eXBlIENvbmZpZyBzdHJ1\nY3QgewoJY29uZmlnLlNES0NvbmZpZyBgeWFtbDoiLGlubGluZSJgCgkvLyBI\nb3N0IGlzIHRoZSBuZXR3b3JrIGhvc3QvaW50ZXJmYWNlIG9uIHdoaWNoIHRo\nZSBBUEkgc2VydmVyIHdpbGwgYmluZC4KCS8vIERlZmF1bHQgaXMgZW1wdHkg\nKCIiKSB0byBiaW5kIGFsbCBpbnRlcmZhY2VzIChJUHY0ICsgSVB2NikuIFVz\nZSAiMTI3LjAuMC4xIiBvciAibG9jYWxob3N0IiBmb3IgbG9jYWwtb25seSBh\nY2Nlc3MuCglIb3N0IHN0cmluZyBgeWFtbDoiaG9zdCIganNvbjoiLSJgCgkv\nLyBQb3J0IGlzIHRoZSBuZXR3b3JrIHBvcnQgb24gd2hpY2ggdGhlIEFQSSBz\nZXJ2ZXIgd2lsbCBsaXN0ZW4uCglQb3J0IGludCBgeWFtbDoicG9ydCIganNv\nbjoiLSJgCgoJLy8gVExTIGNvbmZpZyBjb250cm9scyBIVFRQUyBzZXJ2ZXIg\nc2V0dGluZ3MuCglUTFMgVExTQ29uZmlnIGB5YW1sOiJ0bHMiIGpzb246InRs\ncyJgCgoJLy8gUmVtb3RlTWFuYWdlbWVudCBuZXN0cyBtYW5hZ2VtZW50LXJl\nbGF0ZWQgb3B0aW9ucyB1bmRlciAncmVtb3RlLW1hbmFnZW1lbnQnLgoJUmVt\nb3RlTWFuYWdlbWVudCBSZW1vdGVNYW5hZ2VtZW50IGB5YW1sOiJyZW1vdGUt\nbWFuYWdlbWVudCIganNvbjoiLSJgCgoJLy8gQXV0aERpciBpcyB0aGUgZGly\nZWN0b3J5IHdoZXJlIGF1dGhlbnRpY2F0aW9uIHRva2VuIGZpbGVzIGFyZSBz\ndG9yZWQuCglBdXRoRGlyIHN0cmluZyBgeWFtbDoiYXV0aC1kaXIiIGpzb246\nIi0iYAoKCS8vIERlYnVnIGVuYWJsZXMgb3IgZGlzYWJsZXMgZGVidWctbGV2\nZWwgbG9nZ2luZyBhbmQgb3RoZXIgZGVidWcgZmVhdHVyZXMuCglEZWJ1ZyBi\nb29sIGB5YW1sOiJkZWJ1ZyIganNvbjoiZGVidWciYAoKCS8vIExvZ2dpbmdU\nb0ZpbGUgY29udHJvbHMgd2hldGhlciBhcHBsaWNhdGlvbiBsb2dzIGFyZSB3\ncml0dGVuIHRvIHJvdGF0aW5nIGZpbGVzIG9yIHN0ZG91dC4KCUxvZ2dpbmdU\nb0ZpbGUgYm9vbCBgeWFtbDoibG9nZ2luZy10by1maWxlIiBqc29uOiJsb2dn\naW5nLXRvLWZpbGUiYAoKCS8vIFVzYWdlU3RhdGlzdGljc0VuYWJsZWQgdG9n\nZ2xlcyBpbi1tZW1vcnkgdXNhZ2UgYWdncmVnYXRpb247IHdoZW4gZmFsc2Us\nIHVzYWdlIGRhdGEgaXMgZGlzY2FyZGVkLgoJVXNhZ2VTdGF0aXN0aWNzRW5h\nYmxlZCBib29sIGB5YW1sOiJ1c2FnZS1zdGF0aXN0aWNzLWVuYWJsZWQiIGpz\nb246InVzYWdlLXN0YXRpc3RpY3MtZW5hYmxlZCJgCgoJLy8gRGlzYWJsZUNv\nb2xpbmcgZGlzYWJsZXMgcXVvdGEgY29vbGRvd24gc2NoZWR1bGluZyB3aGVu\nIHRydWUuCglEaXNhYmxlQ29vbGluZyBib29sIGB5YW1sOiJkaXNhYmxlLWNv\nb2xpbmciIGpzb246ImRpc2FibGUtY29vbGluZyJgCgoJLy8gUmVxdWVzdFJl\ndHJ5IGRlZmluZXMgdGhlIHJldHJ5IHRpbWVzIHdoZW4gdGhlIHJlcXVlc3Qg\nZmFpbGVkLgoJUmVxdWVzdFJldHJ5IGludCBgeWFtbDoicmVxdWVzdC1yZXRy\neSIganNvbjoicmVxdWVzdC1yZXRyeSJgCgkvLyBNYXhSZXRyeUludGVydmFs\nIGRlZmluZXMgdGhlIG1heGltdW0gd2FpdCB0aW1lIGluIHNlY29uZHMgYmVm\nb3JlIHJldHJ5aW5nIGEgY29vbGVkLWRvd24gY3JlZGVudGlhbC4KCU1heFJl\ndHJ5SW50ZXJ2YWwgaW50IGB5YW1sOiJtYXgtcmV0cnktaW50ZXJ2YWwiIGpz\nb246Im1heC1yZXRyeS1pbnRlcnZhbCJgCgoJLy8gUXVvdGFFeGNlZWRlZCBk\nZWZpbmVzIHRoZSBiZWhhdmlvciB3aGVuIGEgcXVvdGEgaXMgZXhjZWVkZWQu\nCglRdW90YUV4Y2VlZGVkIFF1b3RhRXhjZWVkZWQgYHlhbWw6InF1b3RhLWV4\nY2VlZGVkIiBqc29uOiJxdW90YS1leGNlZWRlZCJgCgoJLy8gV2Vic29ja2V0\nQXV0aCBlbmFibGVzIG9yIGRpc2FibGVzIGF1dGhlbnRpY2F0aW9uIGZvciB0\naGUgV2ViU29ja2V0IEFQSS4KCVdlYnNvY2tldEF1dGggYm9vbCBgeWFtbDoi\nd3MtYXV0aCIganNvbjoid3MtYXV0aCJgCgoJLy8gR2VtaW5pS2V5IGRlZmlu\nZXMgR2VtaW5pIEFQSSBrZXkgY29uZmlndXJhdGlvbnMgd2l0aCBvcHRpb25h\nbCByb3V0aW5nIG92ZXJyaWRlcy4KCUdlbWluaUtleSBbXUdlbWluaUtleSBg\neWFtbDoiZ2VtaW5pLWFwaS1rZXkiIGpzb246ImdlbWluaS1hcGkta2V5ImAK\nCgkvLyBDb2RleCBkZWZpbmVzIGEgbGlzdCBvZiBDb2RleCBBUEkga2V5IGNv\nbmZpZ3VyYXRpb25zIGFzIHNwZWNpZmllZCBpbiB0aGUgWUFNTCBjb25maWd1\ncmF0aW9uIGZpbGUuCglDb2RleEtleSBbXUNvZGV4S2V5IGB5YW1sOiJjb2Rl\neC1hcGkta2V5IiBqc29uOiJjb2RleC1hcGkta2V5ImAKCgkvLyBDbGF1ZGVL\nZXkgZGVmaW5lcyBhIGxpc3Qgb2YgQ2xhdWRlIEFQSSBrZXkgY29uZmlndXJh\ndGlvbnMgYXMgc3BlY2lmaWVkIGluIHRoZSBZQU1MIGNvbmZpZ3VyYXRpb24g\nZmlsZS4KCUNsYXVkZUtleSBbXUNsYXVkZUtleSBgeWFtbDoiY2xhdWRlLWFw\naS1rZXkiIGpzb246ImNsYXVkZS1hcGkta2V5ImAKCgkvLyBPcGVuQUlDb21w\nYXRpYmlsaXR5IGRlZmluZXMgT3BlbkFJIEFQSSBjb21wYXRpYmlsaXR5IGNv\nbmZpZ3VyYXRpb25zIGZvciBleHRlcm5hbCBwcm92aWRlcnMuCglPcGVuQUlD\nb21wYXRpYmlsaXR5IFtdT3BlbkFJQ29tcGF0aWJpbGl0eSBgeWFtbDoib3Bl\nbmFpLWNvbXBhdGliaWxpdHkiIGpzb246Im9wZW5haS1jb21wYXRpYmlsaXR5\nImAKCgkvLyBWZXJ0ZXhDb21wYXRBUElLZXkgZGVmaW5lcyBWZXJ0ZXggQUkt\nY29tcGF0aWJsZSBBUEkga2V5IGNvbmZpZ3VyYXRpb25zIGZvciB0aGlyZC1w\nYXJ0eSBwcm92aWRlcnMuCgkvLyBVc2VkIGZvciBzZXJ2aWNlcyB0aGF0IHVz\nZSBWZXJ0ZXggQUktc3R5bGUgcGF0aHMgYnV0IHdpdGggc2ltcGxlIEFQSSBr\nZXkgYXV0aGVudGljYXRpb24uCglWZXJ0ZXhDb21wYXRBUElLZXkgW11WZXJ0\nZXhDb21wYXRLZXkgYHlhbWw6InZlcnRleC1hcGkta2V5IiBqc29uOiJ2ZXJ0\nZXgtYXBpLWtleSJgCgoJLy8gQW1wQ29kZSBjb250YWlucyBBbXAgQ0xJIHVw\nc3RyZWFtIGNvbmZpZ3VyYXRpb24sIG1hbmFnZW1lbnQgcmVzdHJpY3Rpb25z\nLCBhbmQgbW9kZWwgbWFwcGluZ3MuCglBbXBDb2RlIEFtcENvZGUgYHlhbWw6\nImFtcGNvZGUiIGpzb246ImFtcGNvZGUiYAoKCS8vIE9BdXRoRXhjbHVkZWRN\nb2RlbHMgZGVmaW5lcyBwZXItcHJvdmlkZXIgZ2xvYmFsIG1vZGVsIGV4Y2x1\nc2lvbnMgYXBwbGllZCB0byBPQXV0aC9maWxlLWJhY2tlZCBhdXRoIGVudHJp\nZXMuCglPQXV0aEV4Y2x1ZGVkTW9kZWxzIG1hcFtzdHJpbmddW11zdHJpbmcg\nYHlhbWw6Im9hdXRoLWV4Y2x1ZGVkLW1vZGVscyxvbWl0ZW1wdHkiIGpzb246\nIm9hdXRoLWV4Y2x1ZGVkLW1vZGVscyxvbWl0ZW1wdHkiYAoKCS8vIFBheWxv\nYWQgZGVmaW5lcyBkZWZhdWx0IGFuZCBvdmVycmlkZSBydWxlcyBmb3IgcHJv\ndmlkZXIgcGF5bG9hZCBwYXJhbWV0ZXJzLgoJUGF5bG9hZCBQYXlsb2FkQ29u\nZmlnIGB5YW1sOiJwYXlsb2FkIiBqc29uOiJwYXlsb2FkImAKCglsZWdhY3lN\naWdyYXRpb25QZW5kaW5nIGJvb2wgYHlhbWw6Ii0iIGpzb246Ii0iYAp9Cgov\nLyBUTFNDb25maWcgaG9sZHMgSFRUUFMgc2VydmVyIHNldHRpbmdzLgp0eXBl\nIFRMU0NvbmZpZyBzdHJ1Y3QgewoJLy8gRW5hYmxlIHRvZ2dsZXMgSFRUUFMg\nc2VydmVyIG1vZGUuCglFbmFibGUgYm9vbCBgeWFtbDoiZW5hYmxlIiBqc29u\nOiJlbmFibGUiYAoJLy8gQ2VydCBpcyB0aGUgcGF0aCB0byB0aGUgVExTIGNl\ncnRpZmljYXRlIGZpbGUuCglDZXJ0IHN0cmluZyBgeWFtbDoiY2VydCIganNv\nbjoiY2VydCJgCgkvLyBLZXkgaXMgdGhlIHBhdGggdG8gdGhlIFRMUyBwcml2\nYXRlIGtleSBmaWxlLgoJS2V5IHN0cmluZyBgeWFtbDoia2V5IiBqc29uOiJr\nZXkiYAp9CgovLyBSZW1vdGVNYW5hZ2VtZW50IGhvbGRzIG1hbmFnZW1lbnQg\nQVBJIGNvbmZpZ3VyYXRpb24gdW5kZXIgJ3JlbW90ZS1tYW5hZ2VtZW50Jy4K\ndHlwZSBSZW1vdGVNYW5hZ2VtZW50IHN0cnVjdCB7CgkvLyBBbGxvd1JlbW90\nZSB0b2dnbGVzIHJlbW90ZSAobm9uLWxvY2FsaG9zdCkgYWNjZXNzIHRvIG1h\nbmFnZW1lbnQgQVBJLgoJQWxsb3dSZW1vdGUgYm9vbCBgeWFtbDoiYWxsb3ct\ncmVtb3RlImAKCS8vIFNlY3JldEtleSBpcyB0aGUgbWFuYWdlbWVudCBrZXkg\nKHBsYWludGV4dCBvciBiY3J5cHQgaGFzaGVkKS4gWUFNTCBrZXkgaW50ZW50\naW9uYWxseSAnc2VjcmV0LWtleScuCglTZWNyZXRLZXkgc3RyaW5nIGB5YW1s\nOiJzZWNyZXQta2V5ImAKCS8vIERpc2FibGVDb250cm9sUGFuZWwgc2tpcHMg\nc2VydmluZyBhbmQgc3luY2luZyB0aGUgYnVuZGxlZCBtYW5hZ2VtZW50IFVJ\nIHdoZW4gdHJ1ZS4KCURpc2FibGVDb250cm9sUGFuZWwgYm9vbCBgeWFtbDoi\nZGlzYWJsZS1jb250cm9sLXBhbmVsImAKfQoKLy8gUXVvdGFFeGNlZWRlZCBk\nZWZpbmVzIHRoZSBiZWhhdmlvciB3aGVuIEFQSSBxdW90YSBsaW1pdHMgYXJl\nIGV4Y2VlZGVkLgovLyBJdCBwcm92aWRlcyBjb25maWd1cmF0aW9uIG9wdGlv\nbnMgZm9yIGF1dG9tYXRpYyBmYWlsb3ZlciBtZWNoYW5pc21zLgp0eXBlIFF1\nb3RhRXhjZWVkZWQgc3RydWN0IHsKCS8vIFN3aXRjaFByb2plY3QgaW5kaWNh\ndGVzIHdoZXRoZXIgdG8gYXV0b21hdGljYWxseSBzd2l0Y2ggdG8gYW5vdGhl\nciBwcm9qZWN0IHdoZW4gYSBxdW90YSBpcyBleGNlZWRlZC4KCVN3aXRjaFBy\nb2plY3QgYm9vbCBgeWFtbDoic3dpdGNoLXByb2plY3QiIGpzb246InN3aXRj\naC1wcm9qZWN0ImAKCgkvLyBTd2l0Y2hQcmV2aWV3TW9kZWwgaW5kaWNhdGVz\nIHdoZXRoZXIgdG8gYXV0b21hdGljYWxseSBzd2l0Y2ggdG8gYSBwcmV2aWV3\nIG1vZGVsIHdoZW4gYSBxdW90YSBpcyBleGNlZWRlZC4KCVN3aXRjaFByZXZp\nZXdNb2RlbCBib29sIGB5YW1sOiJzd2l0Y2gtcHJldmlldy1tb2RlbCIganNv\nbjoic3dpdGNoLXByZXZpZXctbW9kZWwiYAp9CgovLyBBbXBNb2RlbE1hcHBp\nbmcgZGVmaW5lcyBhIG1vZGVsIG5hbWUgbWFwcGluZyBmb3IgQW1wIENMSSBy\nZXF1ZXN0cy4KLy8gV2hlbiBBbXAgcmVxdWVzdHMgYSBtb2RlbCB0aGF0IGlz\nbid0IGF2YWlsYWJsZSBsb2NhbGx5LCB0aGlzIG1hcHBpbmcKLy8gYWxsb3dz\nIHJvdXRpbmcgdG8gYW4gYWx0ZXJuYXRpdmUgbW9kZWwgdGhhdCBJUyBhdmFp\nbGFibGUuCnR5cGUgQW1wTW9kZWxNYXBwaW5nIHN0cnVjdCB7CgkvLyBGcm9t\nIGlzIHRoZSBtb2RlbCBuYW1lIHRoYXQgQW1wIENMSSByZXF1ZXN0cyAoZS5n\nLiwgImNsYXVkZS1vcHVzLTQuNSIpLgoJRnJvbSBzdHJpbmcgYHlhbWw6ImZy\nb20iIGpzb246ImZyb20iYAoKCS8vIFRvIGlzIHRoZSB0YXJnZXQgbW9kZWwg\nbmFtZSB0byByb3V0ZSB0byAoZS5nLiwgImNsYXVkZS1zb25uZXQtNCIpLgoJ\nLy8gVGhlIHRhcmdldCBtb2RlbCBtdXN0IGhhdmUgYXZhaWxhYmxlIHByb3Zp\nZGVycyBpbiB0aGUgcmVnaXN0cnkuCglUbyBzdHJpbmcgYHlhbWw6InRvIiBq\nc29uOiJ0byJgCn0KCi8vIEFtcENvZGUgZ3JvdXBzIEFtcCBDTEkgaW50ZWdy\nYXRpb24gc2V0dGluZ3MgaW5jbHVkaW5nIHVwc3RyZWFtIHJvdXRpbmcsCi8v\nIG9wdGlvbmFsIG92ZXJyaWRlcywgbWFuYWdlbWVudCByb3V0ZSByZXN0cmlj\ndGlvbnMsIGFuZCBtb2RlbCBmYWxsYmFjayBtYXBwaW5ncy4KdHlwZSBBbXBD\nb2RlIHN0cnVjdCB7CgkvLyBVcHN0cmVhbVVSTCBkZWZpbmVzIHRoZSB1cHN0\ncmVhbSBBbXAgY29udHJvbCBwbGFuZSB1c2VkIGZvciBub24tcHJvdmlkZXIg\nY2FsbHMuCglVcHN0cmVhbVVSTCBzdHJpbmcgYHlhbWw6InVwc3RyZWFtLXVy\nbCIganNvbjoidXBzdHJlYW0tdXJsImAKCgkvLyBVcHN0cmVhbUFQSUtleSBv\ncHRpb25hbGx5IG92ZXJyaWRlcyB0aGUgQXV0aG9yaXphdGlvbiBoZWFkZXIg\nd2hlbiBwcm94eWluZyBBbXAgdXBzdHJlYW0gY2FsbHMuCglVcHN0cmVhbUFQ\nSUtleSBzdHJpbmcgYHlhbWw6InVwc3RyZWFtLWFwaS1rZXkiIGpzb246InVw\nc3RyZWFtLWFwaS1rZXkiYAoKCS8vIFJlc3RyaWN0TWFuYWdlbWVudFRvTG9j\nYWxob3N0IHJlc3RyaWN0cyBBbXAgbWFuYWdlbWVudCByb3V0ZXMgKC9hcGkv\ndXNlciwgL2FwaS90aHJlYWRzLCBldGMuKQoJLy8gdG8gb25seSBhY2NlcHQg\nY29ubmVjdGlvbnMgZnJvbSBsb2NhbGhvc3QgKDEyNy4wLjAuMSwgOjoxKS4g\nV2hlbiB0cnVlLCBwcmV2ZW50cyBkcml2ZS1ieQoJLy8gYnJvd3NlciBhdHRh\nY2tzIGFuZCByZW1vdGUgYWNjZXNzIHRvIG1hbmFnZW1lbnQgZW5kcG9pbnRz\nLiBEZWZhdWx0OiB0cnVlIChyZWNvbW1lbmRlZCkuCglSZXN0cmljdE1hbmFn\nZW1lbnRUb0xvY2FsaG9zdCBib29sIGB5YW1sOiJyZXN0cmljdC1tYW5hZ2Vt\nZW50LXRvLWxvY2FsaG9zdCIganNvbjoicmVzdHJpY3QtbWFuYWdlbWVudC10\nby1sb2NhbGhvc3QiYAoKCS8vIE1vZGVsTWFwcGluZ3MgZGVmaW5lcyBtb2Rl\nbCBuYW1lIG1hcHBpbmdzIGZvciBBbXAgQ0xJIHJlcXVlc3RzLgoJLy8gV2hl\nbiBBbXAgcmVxdWVzdHMgYSBtb2RlbCB0aGF0IGlzbid0IGF2YWlsYWJsZSBs\nb2NhbGx5LCB0aGVzZSBtYXBwaW5ncwoJLy8gYWxsb3cgcm91dGluZyB0byBh\nbiBhbHRlcm5hdGl2ZSBtb2RlbCB0aGF0IElTIGF2YWlsYWJsZS4KCU1vZGVs\nTWFwcGluZ3MgW11BbXBNb2RlbE1hcHBpbmcgYHlhbWw6Im1vZGVsLW1hcHBp\nbmdzIiBqc29uOiJtb2RlbC1tYXBwaW5ncyJgCgoJLy8gRm9yY2VNb2RlbE1h\ncHBpbmdzIHdoZW4gdHJ1ZSwgbW9kZWwgbWFwcGluZ3MgdGFrZSBwcmVjZWRl\nbmNlIG92ZXIgbG9jYWwgQVBJIGtleXMuCgkvLyBXaGVuIGZhbHNlIChkZWZh\ndWx0KSwgbG9jYWwgQVBJIGtleXMgYXJlIHVzZWQgZmlyc3QgaWYgYXZhaWxh\nYmxlLgoJRm9yY2VNb2RlbE1hcHBpbmdzIGJvb2wgYHlhbWw6ImZvcmNlLW1v\nZGVsLW1hcHBpbmdzIiBqc29uOiJmb3JjZS1tb2RlbC1tYXBwaW5ncyJgCn0K\nCi8vIFBheWxvYWRDb25maWcgZGVmaW5lcyBkZWZhdWx0IGFuZCBvdmVycmlk\nZSBwYXJhbWV0ZXIgcnVsZXMgYXBwbGllZCB0byBwcm92aWRlciBwYXlsb2Fk\ncy4KdHlwZSBQYXlsb2FkQ29uZmlnIHN0cnVjdCB7CgkvLyBEZWZhdWx0IGRl\nZmluZXMgcnVsZXMgdGhhdCBvbmx5IHNldCBwYXJhbWV0ZXJzIHdoZW4gdGhl\neSBhcmUgbWlzc2luZyBpbiB0aGUgcGF5bG9hZC4KCURlZmF1bHQgW11QYXls\nb2FkUnVsZSBgeWFtbDoiZGVmYXVsdCIganNvbjoiZGVmYXVsdCJgCgkvLyBP\ndmVycmlkZSBkZWZpbmVzIHJ1bGVzIHRoYXQgYWx3YXlzIHNldCBwYXJhbWV0\nZXJzLCBvdmVyd3JpdGluZyBhbnkgZXhpc3RpbmcgdmFsdWVzLgoJT3ZlcnJp\nZGUgW11QYXlsb2FkUnVsZSBgeWFtbDoib3ZlcnJpZGUiIGpzb246Im92ZXJy\naWRlImAKfQoKLy8gUGF5bG9hZFJ1bGUgZGVzY3JpYmVzIGEgc2luZ2xlIHJ1\nbGUgdGFyZ2V0aW5nIGEgbGlzdCBvZiBtb2RlbHMgd2l0aCBwYXJhbWV0ZXIg\ndXBkYXRlcy4KdHlwZSBQYXlsb2FkUnVsZSBzdHJ1Y3QgewoJLy8gTW9kZWxz\nIGxpc3RzIG1vZGVsIGVudHJpZXMgd2l0aCBuYW1lIHBhdHRlcm4gYW5kIHBy\nb3RvY29sIGNvbnN0cmFpbnQuCglNb2RlbHMgW11QYXlsb2FkTW9kZWxSdWxl\nIGB5YW1sOiJtb2RlbHMiIGpzb246Im1vZGVscyJgCgkvLyBQYXJhbXMgbWFw\ncyBKU09OIHBhdGhzIChnanNvbi9zanNvbiBzeW50YXgpIHRvIHZhbHVlcyB3\ncml0dGVuIGludG8gdGhlIHBheWxvYWQuCglQYXJhbXMgbWFwW3N0cmluZ11h\nbnkgYHlhbWw6InBhcmFtcyIganNvbjoicGFyYW1zImAKfQoKLy8gUGF5bG9h\nZE1vZGVsUnVsZSB0aWVzIGEgbW9kZWwgbmFtZSBwYXR0ZXJuIHRvIGEgc3Bl\nY2lmaWMgdHJhbnNsYXRvciBwcm90b2NvbC4KdHlwZSBQYXlsb2FkTW9kZWxS\ndWxlIHN0cnVjdCB7CgkvLyBOYW1lIGlzIHRoZSBtb2RlbCBuYW1lIG9yIHdp\nbGRjYXJkIHBhdHRlcm4gKGUuZy4sICJncHQtKiIsICIqLTUiLCAiZ2VtaW5p\nLSotcHJvIikuCglOYW1lIHN0cmluZyBgeWFtbDoibmFtZSIganNvbjoibmFt\nZSJgCgkvLyBQcm90b2NvbCByZXN0cmljdHMgdGhlIHJ1bGUgdG8gYSBzcGVj\naWZpYyB0cmFuc2xhdG9yIGZvcm1hdCAoZS5nLiwgImdlbWluaSIsICJyZXNw\nb25zZXMiKS4KCVByb3RvY29sIHN0cmluZyBgeWFtbDoicHJvdG9jb2wiIGpz\nb246InByb3RvY29sImAKfQoKLy8gQ2xhdWRlS2V5IHJlcHJlc2VudHMgdGhl\nIGNvbmZpZ3VyYXRpb24gZm9yIGEgQ2xhdWRlIEFQSSBrZXksCi8vIGluY2x1\nZGluZyB0aGUgQVBJIGtleSBpdHNlbGYgYW5kIGFuIG9wdGlvbmFsIGJhc2Ug\nVVJMIGZvciB0aGUgQVBJIGVuZHBvaW50Lgp0eXBlIENsYXVkZUtleSBzdHJ1\nY3QgewoJLy8gQVBJS2V5IGlzIHRoZSBhdXRoZW50aWNhdGlvbiBrZXkgZm9y\nIGFjY2Vzc2luZyBDbGF1ZGUgQVBJIHNlcnZpY2VzLgoJQVBJS2V5IHN0cmlu\nZyBgeWFtbDoiYXBpLWtleSIganNvbjoiYXBpLWtleSJgCgoJLy8gQmFzZVVS\nTCBpcyB0aGUgYmFzZSBVUkwgZm9yIHRoZSBDbGF1ZGUgQVBJIGVuZHBvaW50\nLgoJLy8gSWYgZW1wdHksIHRoZSBkZWZhdWx0IENsYXVkZSBBUEkgVVJMIHdp\nbGwgYmUgdXNlZC4KCUJhc2VVUkwgc3RyaW5nIGB5YW1sOiJiYXNlLXVybCIg\nanNvbjoiYmFzZS11cmwiYAoKCS8vIFByb3h5VVJMIG92ZXJyaWRlcyB0aGUg\nZ2xvYmFsIHByb3h5IHNldHRpbmcgZm9yIHRoaXMgQVBJIGtleSBpZiBwcm92\naWRlZC4KCVByb3h5VVJMIHN0cmluZyBgeWFtbDoicHJveHktdXJsIiBqc29u\nOiJwcm94eS11cmwiYAoKCS8vIE1vZGVscyBkZWZpbmVzIHVwc3RyZWFtIG1v\nZGVsIG5hbWVzIGFuZCBhbGlhc2VzIGZvciByZXF1ZXN0IHJvdXRpbmcuCglN\nb2RlbHMgW11DbGF1ZGVNb2RlbCBgeWFtbDoibW9kZWxzIiBqc29uOiJtb2Rl\nbHMiYAoKCS8vIEhlYWRlcnMgb3B0aW9uYWxseSBhZGRzIGV4dHJhIEhUVFAg\naGVhZGVycyBmb3IgcmVxdWVzdHMgc2VudCB3aXRoIHRoaXMga2V5LgoJSGVh\nZGVycyBtYXBbc3RyaW5nXXN0cmluZyBgeWFtbDoiaGVhZGVycyxvbWl0ZW1w\ndHkiIGpzb246ImhlYWRlcnMsb21pdGVtcHR5ImAKCgkvLyBFeGNsdWRlZE1v\nZGVscyBsaXN0cyBtb2RlbCBJRHMgdGhhdCBzaG91bGQgYmUgZXhjbHVkZWQg\nZm9yIHRoaXMgcHJvdmlkZXIuCglFeGNsdWRlZE1vZGVscyBbXXN0cmluZyBg\neWFtbDoiZXhjbHVkZWQtbW9kZWxzLG9taXRlbXB0eSIganNvbjoiZXhjbHVk\nZWQtbW9kZWxzLG9taXRlbXB0eSJgCn0KCi8vIENsYXVkZU1vZGVsIGRlc2Ny\naWJlcyBhIG1hcHBpbmcgYmV0d2VlbiBhbiBhbGlhcyBhbmQgdGhlIGFjdHVh\nbCB1cHN0cmVhbSBtb2RlbCBuYW1lLgp0eXBlIENsYXVkZU1vZGVsIHN0cnVj\ndCB7CgkvLyBOYW1lIGlzIHRoZSB1cHN0cmVhbSBtb2RlbCBpZGVudGlmaWVy\nIHVzZWQgd2hlbiBpc3N1aW5nIHJlcXVlc3RzLgoJTmFtZSBzdHJpbmcgYHlh\nbWw6Im5hbWUiIGpzb246Im5hbWUiYAoKCS8vIEFsaWFzIGlzIHRoZSBjbGll\nbnQtZmFjaW5nIG1vZGVsIG5hbWUgdGhhdCBtYXBzIHRvIE5hbWUuCglBbGlh\ncyBzdHJpbmcgYHlhbWw6ImFsaWFzIiBqc29uOiJhbGlhcyJgCn0KCi8vIENv\nZGV4S2V5IHJlcHJlc2VudHMgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIGEgQ29k\nZXggQVBJIGtleSwKLy8gaW5jbHVkaW5nIHRoZSBBUEkga2V5IGl0c2VsZiBh\nbmQgYW4gb3B0aW9uYWwgYmFzZSBVUkwgZm9yIHRoZSBBUEkgZW5kcG9pbnQu\nCnR5cGUgQ29kZXhLZXkgc3RydWN0IHsKCS8vIEFQSUtleSBpcyB0aGUgYXV0\naGVudGljYXRpb24ga2V5IGZvciBhY2Nlc3NpbmcgQ29kZXggQVBJIHNlcnZp\nY2VzLgoJQVBJS2V5IHN0cmluZyBgeWFtbDoiYXBpLWtleSIganNvbjoiYXBp\nLWtleSJgCgoJLy8gQmFzZVVSTCBpcyB0aGUgYmFzZSBVUkwgZm9yIHRoZSBD\nb2RleCBBUEkgZW5kcG9pbnQuCgkvLyBJZiBlbXB0eSwgdGhlIGRlZmF1bHQg\nQ29kZXggQVBJIFVSTCB3aWxsIGJlIHVzZWQuCglCYXNlVVJMIHN0cmluZyBg\neWFtbDoiYmFzZS11cmwiIGpzb246ImJhc2UtdXJsImAKCgkvLyBQcm94eVVS\nTCBvdmVycmlkZXMgdGhlIGdsb2JhbCBwcm94eSBzZXR0aW5nIGZvciB0aGlz\nIEFQSSBrZXkgaWYgcHJvdmlkZWQuCglQcm94eVVSTCBzdHJpbmcgYHlhbWw6\nInByb3h5LXVybCIganNvbjoicHJveHktdXJsImAKCgkvLyBIZWFkZXJzIG9w\ndGlvbmFsbHkgYWRkcyBleHRyYSBIVFRQIGhlYWRlcnMgZm9yIHJlcXVlc3Rz\nIHNlbnQgd2l0aCB0aGlzIGtleS4KCUhlYWRlcnMgbWFwW3N0cmluZ11zdHJp\nbmcgYHlhbWw6ImhlYWRlcnMsb21pdGVtcHR5IiBqc29uOiJoZWFkZXJzLG9t\naXRlbXB0eSJgCgoJLy8gRXhjbHVkZWRNb2RlbHMgbGlzdHMgbW9kZWwgSURz\nIHRoYXQgc2hvdWxkIGJlIGV4Y2x1ZGVkIGZvciB0aGlzIHByb3ZpZGVyLgoJ\nRXhjbHVkZWRNb2RlbHMgW11zdHJpbmcgYHlhbWw6ImV4Y2x1ZGVkLW1vZGVs\ncyxvbWl0ZW1wdHkiIGpzb246ImV4Y2x1ZGVkLW1vZGVscyxvbWl0ZW1wdHki\nYAp9CgovLyBHZW1pbmlLZXkgcmVwcmVzZW50cyB0aGUgY29uZmlndXJhdGlv\nbiBmb3IgYSBHZW1pbmkgQVBJIGtleSwKLy8gaW5jbHVkaW5nIG9wdGlvbmFs\nIG92ZXJyaWRlcyBmb3IgdXBzdHJlYW0gYmFzZSBVUkwsIHByb3h5IHJvdXRp\nbmcsIGFuZCBoZWFkZXJzLgp0eXBlIEdlbWluaUtleSBzdHJ1Y3QgewoJLy8g\nQVBJS2V5IGlzIHRoZSBhdXRoZW50aWNhdGlvbiBrZXkgZm9yIGFjY2Vzc2lu\nZyBHZW1pbmkgQVBJIHNlcnZpY2VzLgoJQVBJS2V5IHN0cmluZyBgeWFtbDoi\nYXBpLWtleSIganNvbjoiYXBpLWtleSJgCgoJLy8gQmFzZVVSTCBvcHRpb25h\nbGx5IG92ZXJyaWRlcyB0aGUgR2VtaW5pIEFQSSBlbmRwb2ludC4KCUJhc2VV\nUkwgc3RyaW5nIGB5YW1sOiJiYXNlLXVybCxvbWl0ZW1wdHkiIGpzb246ImJh\nc2UtdXJsLG9taXRlbXB0eSJgCgoJLy8gUHJveHlVUkwgb3B0aW9uYWxseSBv\ndmVycmlkZXMgdGhlIGdsb2JhbCBwcm94eSBmb3IgdGhpcyBBUEkga2V5LgoJ\nUHJveHlVUkwgc3RyaW5nIGB5YW1sOiJwcm94eS11cmwsb21pdGVtcHR5IiBq\nc29uOiJwcm94eS11cmwsb21pdGVtcHR5ImAKCgkvLyBIZWFkZXJzIG9wdGlv\nbmFsbHkgYWRkcyBleHRyYSBIVFRQIGhlYWRlcnMgZm9yIHJlcXVlc3RzIHNl\nbnQgd2l0aCB0aGlzIGtleS4KCUhlYWRlcnMgbWFwW3N0cmluZ11zdHJpbmcg\nYHlhbWw6ImhlYWRlcnMsb21pdGVtcHR5IiBqc29uOiJoZWFkZXJzLG9taXRl\nbXB0eSJgCgoJLy8gRXhjbHVkZWRNb2RlbHMgbGlzdHMgbW9kZWwgSURzIHRo\nYXQgc2hvdWxkIGJlIGV4Y2x1ZGVkIGZvciB0aGlzIHByb3ZpZGVyLgoJRXhj\nbHVkZWRNb2RlbHMgW11zdHJpbmcgYHlhbWw6ImV4Y2x1ZGVkLW1vZGVscyxv\nbWl0ZW1wdHkiIGpzb246ImV4Y2x1ZGVkLW1vZGVscyxvbWl0ZW1wdHkiYAp9\nCgovLyBPcGVuQUlDb21wYXRpYmlsaXR5IHJlcHJlc2VudHMgdGhlIGNvbmZp\nZ3VyYXRpb24gZm9yIE9wZW5BSSBBUEkgY29tcGF0aWJpbGl0eQovLyB3aXRo\nIGV4dGVybmFsIHByb3ZpZGVycywgYWxsb3dpbmcgbW9kZWwgYWxpYXNlcyB0\nbyBiZSByb3V0ZWQgdGhyb3VnaCBPcGVuQUkgQVBJIGZvcm1hdC4KdHlwZSBP\ncGVuQUlDb21wYXRpYmlsaXR5IHN0cnVjdCB7CgkvLyBOYW1lIGlzIHRoZSBp\nZGVudGlmaWVyIGZvciB0aGlzIE9wZW5BSSBjb21wYXRpYmlsaXR5IGNvbmZp\nZ3VyYXRpb24uCglOYW1lIHN0cmluZyBgeWFtbDoibmFtZSIganNvbjoibmFt\nZSJgCgoJLy8gQmFzZVVSTCBpcyB0aGUgYmFzZSBVUkwgZm9yIHRoZSBleHRl\ncm5hbCBPcGVuQUktY29tcGF0aWJsZSBBUEkgZW5kcG9pbnQuCglCYXNlVVJM\nIHN0cmluZyBgeWFtbDoiYmFzZS11cmwiIGpzb246ImJhc2UtdXJsImAKCgkv\nLyBBUElLZXlFbnRyaWVzIGRlZmluZXMgQVBJIGtleXMgd2l0aCBvcHRpb25h\nbCBwZXIta2V5IHByb3h5IGNvbmZpZ3VyYXRpb24uCglBUElLZXlFbnRyaWVz\nIFtdT3BlbkFJQ29tcGF0aWJpbGl0eUFQSUtleSBgeWFtbDoiYXBpLWtleS1l\nbnRyaWVzLG9taXRlbXB0eSIganNvbjoiYXBpLWtleS1lbnRyaWVzLG9taXRl\nbXB0eSJgCgoJLy8gTW9kZWxzIGRlZmluZXMgdGhlIG1vZGVsIGNvbmZpZ3Vy\nYXRpb25zIGluY2x1ZGluZyBhbGlhc2VzIGZvciByb3V0aW5nLgoJTW9kZWxz\nIFtdT3BlbkFJQ29tcGF0aWJpbGl0eU1vZGVsIGB5YW1sOiJtb2RlbHMiIGpz\nb246Im1vZGVscyJgCgoJLy8gSGVhZGVycyBvcHRpb25hbGx5IGFkZHMgZXh0\ncmEgSFRUUCBoZWFkZXJzIGZvciByZXF1ZXN0cyBzZW50IHRvIHRoaXMgcHJv\ndmlkZXIuCglIZWFkZXJzIG1hcFtzdHJpbmddc3RyaW5nIGB5YW1sOiJoZWFk\nZXJzLG9taXRlbXB0eSIganNvbjoiaGVhZGVycyxvbWl0ZW1wdHkiYAp9Cgov\nLyBPcGVuQUlDb21wYXRpYmlsaXR5QVBJS2V5IHJlcHJlc2VudHMgYW4gQVBJ\nIGtleSBjb25maWd1cmF0aW9uIHdpdGggb3B0aW9uYWwgcHJveHkgc2V0dGlu\nZy4KdHlwZSBPcGVuQUlDb21wYXRpYmlsaXR5QVBJS2V5IHN0cnVjdCB7Cgkv\nLyBBUElLZXkgaXMgdGhlIGF1dGhlbnRpY2F0aW9uIGtleSBmb3IgYWNjZXNz\naW5nIHRoZSBleHRlcm5hbCBBUEkgc2VydmljZXMuCglBUElLZXkgc3RyaW5n\nIGB5YW1sOiJhcGkta2V5IiBqc29uOiJhcGkta2V5ImAKCgkvLyBQcm94eVVS\nTCBvdmVycmlkZXMgdGhlIGdsb2JhbCBwcm94eSBzZXR0aW5nIGZvciB0aGlz\nIEFQSSBrZXkgaWYgcHJvdmlkZWQuCglQcm94eVVSTCBzdHJpbmcgYHlhbWw6\nInByb3h5LXVybCxvbWl0ZW1wdHkiIGpzb246InByb3h5LXVybCxvbWl0ZW1w\ndHkiYAp9CgovLyBPcGVuQUlDb21wYXRpYmlsaXR5TW9kZWwgcmVwcmVzZW50\ncyBhIG1vZGVsIGNvbmZpZ3VyYXRpb24gZm9yIE9wZW5BSSBjb21wYXRpYmls\naXR5LAovLyBpbmNsdWRpbmcgdGhlIGFjdHVhbCBtb2RlbCBuYW1lIGFuZCBp\ndHMgYWxpYXMgZm9yIEFQSSByb3V0aW5nLgp0eXBlIE9wZW5BSUNvbXBhdGli\naWxpdHlNb2RlbCBzdHJ1Y3QgewoJLy8gTmFtZSBpcyB0aGUgYWN0dWFsIG1v\nZGVsIG5hbWUgdXNlZCBieSB0aGUgZXh0ZXJuYWwgcHJvdmlkZXIuCglOYW1l\nIHN0cmluZyBgeWFtbDoibmFtZSIganNvbjoibmFtZSJgCgoJLy8gQWxpYXMg\naXMgdGhlIG1vZGVsIG5hbWUgYWxpYXMgdGhhdCBjbGllbnRzIHdpbGwgdXNl\nIHRvIHJlZmVyZW5jZSB0aGlzIG1vZGVsLgoJQWxpYXMgc3RyaW5nIGB5YW1s\nOiJhbGlhcyIganNvbjoiYWxpYXMiYAp9CgovLyBMb2FkQ29uZmlnIHJlYWRz\nIGEgWUFNTCBjb25maWd1cmF0aW9uIGZpbGUgZnJvbSB0aGUgZ2l2ZW4gcGF0\naCwKLy8gdW5tYXJzaGFscyBpdCBpbnRvIGEgQ29uZmlnIHN0cnVjdCwgYXBw\nbGllcyBlbnZpcm9ubWVudCB2YXJpYWJsZSBvdmVycmlkZXMsCi8vIGFuZCBy\nZXR1cm5zIGl0LgovLwovLyBQYXJhbWV0ZXJzOgovLyAgIC0gY29uZmlnRmls\nZTogVGhlIHBhdGggdG8gdGhlIFlBTUwgY29uZmlndXJhdGlvbiBmaWxlCi8v\nCi8vIFJldHVybnM6Ci8vICAgLSAqQ29uZmlnOiBUaGUgbG9hZGVkIGNvbmZp\nZ3VyYXRpb24KLy8gICAtIGVycm9yOiBBbiBlcnJvciBpZiB0aGUgY29uZmln\ndXJhdGlvbiBjb3VsZCBub3QgYmUgbG9hZGVkCmZ1bmMgTG9hZENvbmZpZyhj\nb25maWdGaWxlIHN0cmluZykgKCpDb25maWcsIGVycm9yKSB7CglyZXR1cm4g\nTG9hZENvbmZpZ09wdGlvbmFsKGNvbmZpZ0ZpbGUsIGZhbHNlKQp9CgovLyBM\nb2FkQ29uZmlnT3B0aW9uYWwgcmVhZHMgWUFNTCBmcm9tIGNvbmZpZ0ZpbGUu\nCi8vIElmIG9wdGlvbmFsIGlzIHRydWUgYW5kIHRoZSBmaWxlIGlzIG1pc3Np\nbmcsIGl0IHJldHVybnMgYW4gZW1wdHkgQ29uZmlnLgovLyBJZiBvcHRpb25h\nbCBpcyB0cnVlIGFuZCB0aGUgZmlsZSBpcyBlbXB0eSBvciBpbnZhbGlkLCBp\ndCByZXR1cm5zIGFuIGVtcHR5IENvbmZpZy4KZnVuYyBMb2FkQ29uZmlnT3B0\naW9uYWwoY29uZmlnRmlsZSBzdHJpbmcsIG9wdGlvbmFsIGJvb2wpICgqQ29u\nZmlnLCBlcnJvcikgewoJLy8gUmVhZCB0aGUgZW50aXJlIGNvbmZpZ3VyYXRp\nb24gZmlsZSBpbnRvIG1lbW9yeS4KCWRhdGEsIGVyciA6PSBvcy5SZWFkRmls\nZShjb25maWdGaWxlKQoJaWYgZXJyICE9IG5pbCB7CgkJaWYgb3B0aW9uYWwg\newoJCQlpZiBvcy5Jc05vdEV4aXN0KGVycikgfHwgZXJyb3JzLklzKGVyciwg\nc3lzY2FsbC5FSVNESVIpIHsKCQkJCS8vIE1pc3NpbmcgYW5kIG9wdGlvbmFs\nOiByZXR1cm4gZW1wdHkgY29uZmlnIChjbG91ZCBkZXBsb3kgc3RhbmRieSku\nCgkJCQlyZXR1cm4gJkNvbmZpZ3t9LCBuaWwKCQkJfQoJCX0KCQlyZXR1cm4g\nbmlsLCBmbXQuRXJyb3JmKCJmYWlsZWQgdG8gcmVhZCBjb25maWcgZmlsZTog\nJXciLCBlcnIpCgl9CgoJLy8gSW4gY2xvdWQgZGVwbG95IG1vZGUgKG9wdGlv\nbmFsPXRydWUpLCBpZiBmaWxlIGlzIGVtcHR5IG9yIGNvbnRhaW5zIG9ubHkg\nd2hpdGVzcGFjZSwgcmV0dXJuIGVtcHR5IGNvbmZpZy4KCWlmIG9wdGlvbmFs\nICYmIGxlbihkYXRhKSA9PSAwIHsKCQlyZXR1cm4gJkNvbmZpZ3t9LCBuaWwK\nCX0KCgkvLyBVbm1hcnNoYWwgdGhlIFlBTUwgZGF0YSBpbnRvIHRoZSBDb25m\naWcgc3RydWN0LgoJdmFyIGNmZyBDb25maWcKCS8vIFNldCBkZWZhdWx0cyBi\nZWZvcmUgdW5tYXJzaGFsIHNvIHRoYXQgYWJzZW50IGtleXMga2VlcCBkZWZh\ndWx0cy4KCWNmZy5Ib3N0ID0gIiIgLy8gRGVmYXVsdCBlbXB0eTogYmluZHMg\ndG8gYWxsIGludGVyZmFjZXMgKElQdjQgKyBJUHY2KQoJY2ZnLkxvZ2dpbmdU\nb0ZpbGUgPSBmYWxzZQoJY2ZnLlVzYWdlU3RhdGlzdGljc0VuYWJsZWQgPSBm\nYWxzZQoJY2ZnLkRpc2FibGVDb29saW5nID0gZmFsc2UKCWNmZy5BbXBDb2Rl\nLlJlc3RyaWN0TWFuYWdlbWVudFRvTG9jYWxob3N0ID0gdHJ1ZSAvLyBEZWZh\ndWx0IHRvIHNlY3VyZTogb25seSBsb2NhbGhvc3QgYWNjZXNzCglpZiBlcnIg\nPSB5YW1sLlVubWFyc2hhbChkYXRhLCAmY2ZnKTsgZXJyICE9IG5pbCB7CgkJ\naWYgb3B0aW9uYWwgewoJCQkvLyBJbiBjbG91ZCBkZXBsb3kgbW9kZSwgaWYg\nWUFNTCBwYXJzaW5nIGZhaWxzLCByZXR1cm4gZW1wdHkgY29uZmlnIGluc3Rl\nYWQgb2YgZXJyb3IuCgkJCXJldHVybiAmQ29uZmlne30sIG5pbAoJCX0KCQly\nZXR1cm4gbmlsLCBmbXQuRXJyb3JmKCJmYWlsZWQgdG8gcGFyc2UgY29uZmln\nIGZpbGU6ICV3IiwgZXJyKQoJfQoKCXZhciBsZWdhY3kgbGVnYWN5Q29uZmln\nRGF0YQoJaWYgZXJyTGVnYWN5IDo9IHlhbWwuVW5tYXJzaGFsKGRhdGEsICZs\nZWdhY3kpOyBlcnJMZWdhY3kgPT0gbmlsIHsKCQlpZiBjZmcubWlncmF0ZUxl\nZ2FjeUdlbWluaUtleXMobGVnYWN5LkxlZ2FjeUdlbWluaUtleXMpIHsKCQkJ\nY2ZnLmxlZ2FjeU1pZ3JhdGlvblBlbmRpbmcgPSB0cnVlCgkJfQoJCWlmIGNm\nZy5taWdyYXRlTGVnYWN5T3BlbkFJQ29tcGF0aWJpbGl0eUtleXMobGVnYWN5\nLk9wZW5BSUNvbXBhdCkgewoJCQljZmcubGVnYWN5TWlncmF0aW9uUGVuZGlu\nZyA9IHRydWUKCQl9CgkJaWYgY2ZnLm1pZ3JhdGVMZWdhY3lBbXBDb25maWco\nJmxlZ2FjeSkgewoJCQljZmcubGVnYWN5TWlncmF0aW9uUGVuZGluZyA9IHRy\ndWUKCQl9Cgl9CgoJLy8gSGFzaCByZW1vdGUgbWFuYWdlbWVudCBrZXkgaWYg\ncGxhaW50ZXh0IGlzIGRldGVjdGVkIChuZXN0ZWQpCgkvLyBXZSBjb25zaWRl\nciBhIHZhbHVlIHRvIGJlIGFscmVhZHkgaGFzaGVkIGlmIGl0IGxvb2tzIGxp\na2UgYSBiY3J5cHQgaGFzaCAoJDJhJCwgJDJiJCwgb3IgJDJ5JCBwcmVmaXgp\nLgoJaWYgY2ZnLlJlbW90ZU1hbmFnZW1lbnQuU2VjcmV0S2V5ICE9ICIiICYm\nICFsb29rc0xpa2VCY3J5cHQoY2ZnLlJlbW90ZU1hbmFnZW1lbnQuU2VjcmV0\nS2V5KSB7CgkJaGFzaGVkLCBlcnJIYXNoIDo9IGhhc2hTZWNyZXQoY2ZnLlJl\nbW90ZU1hbmFnZW1lbnQuU2VjcmV0S2V5KQoJCWlmIGVyckhhc2ggIT0gbmls\nIHsKCQkJcmV0dXJuIG5pbCwgZm10LkVycm9yZigiZmFpbGVkIHRvIGhhc2gg\ncmVtb3RlIG1hbmFnZW1lbnQga2V5OiAldyIsIGVyckhhc2gpCgkJfQoJCWNm\nZy5SZW1vdGVNYW5hZ2VtZW50LlNlY3JldEtleSA9IGhhc2hlZAoKCQkvLyBQ\nZXJzaXN0IHRoZSBoYXNoZWQgdmFsdWUgYmFjayB0byB0aGUgY29uZmlnIGZp\nbGUgdG8gYXZvaWQgcmUtaGFzaGluZyBvbiBuZXh0IHN0YXJ0dXAuCgkJLy8g\nUHJlc2VydmUgWUFNTCBjb21tZW50cyBhbmQgb3JkZXJpbmc7IHVwZGF0ZSBv\nbmx5IHRoZSBuZXN0ZWQga2V5LgoJCV8gPSBTYXZlQ29uZmlnUHJlc2VydmVD\nb21tZW50c1VwZGF0ZU5lc3RlZFNjYWxhcihjb25maWdGaWxlLCBbXXN0cmlu\nZ3sicmVtb3RlLW1hbmFnZW1lbnQiLCAic2VjcmV0LWtleSJ9LCBoYXNoZWQp\nCgl9CgoJLy8gU3luYyByZXF1ZXN0IGF1dGhlbnRpY2F0aW9uIHByb3ZpZGVy\ncyB3aXRoIGlubGluZSBBUEkga2V5cyBmb3IgYmFja3dhcmRzIGNvbXBhdGli\naWxpdHkuCglzeW5jSW5saW5lQWNjZXNzUHJvdmlkZXIoJmNmZykKCgkvLyBT\nYW5pdGl6ZSBHZW1pbmkgQVBJIGtleSBjb25maWd1cmF0aW9uIGFuZCBtaWdy\nYXRlIGxlZ2FjeSBlbnRyaWVzLgoJY2ZnLlNhbml0aXplR2VtaW5pS2V5cygp\nCgoJLy8gU2FuaXRpemUgVmVydGV4LWNvbXBhdGlibGUgQVBJIGtleXM6IGRy\nb3AgZW50cmllcyB3aXRob3V0IGJhc2UtdXJsCgljZmcuU2FuaXRpemVWZXJ0\nZXhDb21wYXRLZXlzKCkKCgkvLyBTYW5pdGl6ZSBDb2RleCBrZXlzOiBkcm9w\nIGVudHJpZXMgd2l0aG91dCBiYXNlLXVybAoJY2ZnLlNhbml0aXplQ29kZXhL\nZXlzKCkKCgkvLyBTYW5pdGl6ZSBDbGF1ZGUga2V5IGhlYWRlcnMKCWNmZy5T\nYW5pdGl6ZUNsYXVkZUtleXMoKQoKCS8vIFNhbml0aXplIE9wZW5BSSBjb21w\nYXRpYmlsaXR5IHByb3ZpZGVyczogZHJvcCBlbnRyaWVzIHdpdGhvdXQgYmFz\nZS11cmwKCWNmZy5TYW5pdGl6ZU9wZW5BSUNvbXBhdGliaWxpdHkoKQoKCS8v\nIE5vcm1hbGl6ZSBPQXV0aCBwcm92aWRlciBtb2RlbCBleGNsdXNpb24gbWFw\nLgoJY2ZnLk9BdXRoRXhjbHVkZWRNb2RlbHMgPSBOb3JtYWxpemVPQXV0aEV4\nY2x1ZGVkTW9kZWxzKGNmZy5PQXV0aEV4Y2x1ZGVkTW9kZWxzKQoKCWlmIGNm\nZy5sZWdhY3lNaWdyYXRpb25QZW5kaW5nIHsKCQlmbXQuUHJpbnRsbigiRGV0\nZWN0ZWQgbGVnYWN5IGNvbmZpZ3VyYXRpb24ga2V5cywgYXR0ZW1wdGluZyB0\nbyBwZXJzaXN0IHRoZSBub3JtYWxpemVkIGNvbmZpZy4uLiIpCgkJaWYgIW9w\ndGlvbmFsICYmIGNvbmZpZ0ZpbGUgIT0gIiIgewoJCQlpZiBlcnIgOj0gU2F2\nZUNvbmZpZ1ByZXNlcnZlQ29tbWVudHMoY29uZmlnRmlsZSwgJmNmZyk7IGVy\nciAhPSBuaWwgewoJCQkJcmV0dXJuIG5pbCwgZm10LkVycm9yZigiZmFpbGVk\nIHRvIHBlcnNpc3QgbWlncmF0ZWQgbGVnYWN5IGNvbmZpZzogJXciLCBlcnIp\nCgkJCX0KCQkJZm10LlByaW50bG4oIkxlZ2FjeSBjb25maWd1cmF0aW9uIG5v\ncm1hbGl6ZWQgYW5kIHBlcnNpc3RlZC4iKQoJCX0gZWxzZSB7CgkJCWZtdC5Q\ncmludGxuKCJMZWdhY3kgY29uZmlndXJhdGlvbiBub3JtYWxpemVkIGluIG1l\nbW9yeTsgcGVyc2lzdGVuY2Ugc2tpcHBlZC4iKQoJCX0KCX0KCgkvLyBSZXR1\ncm4gdGhlIHBvcHVsYXRlZCBjb25maWd1cmF0aW9uIHN0cnVjdC4KCXJldHVy\nbiAmY2ZnLCBuaWwKfQoKLy8gU2FuaXRpemVPcGVuQUlDb21wYXRpYmlsaXR5\nIHJlbW92ZXMgT3BlbkFJLWNvbXBhdGliaWxpdHkgcHJvdmlkZXIgZW50cmll\ncyB0aGF0IGFyZQovLyBub3QgYWN0aW9uYWJsZSwgc3BlY2lmaWNhbGx5IHRo\nb3NlIG1pc3NpbmcgYSBCYXNlVVJMLiBJdCB0cmltcyB3aGl0ZXNwYWNlIGJl\nZm9yZQovLyBldmFsdWF0aW9uIGFuZCBwcmVzZXJ2ZXMgdGhlIHJlbGF0aXZl\nIG9yZGVyIG9mIHJlbWFpbmluZyBlbnRyaWVzLgpmdW5jIChjZmcgKkNvbmZp\nZykgU2FuaXRpemVPcGVuQUlDb21wYXRpYmlsaXR5KCkgewoJaWYgY2ZnID09\nIG5pbCB8fCBsZW4oY2ZnLk9wZW5BSUNvbXBhdGliaWxpdHkpID09IDAgewoJ\nCXJldHVybgoJfQoJb3V0IDo9IG1ha2UoW11PcGVuQUlDb21wYXRpYmlsaXR5\nLCAwLCBsZW4oY2ZnLk9wZW5BSUNvbXBhdGliaWxpdHkpKQoJZm9yIGkgOj0g\ncmFuZ2UgY2ZnLk9wZW5BSUNvbXBhdGliaWxpdHkgewoJCWUgOj0gY2ZnLk9w\nZW5BSUNvbXBhdGliaWxpdHlbaV0KCQllLk5hbWUgPSBzdHJpbmdzLlRyaW1T\ncGFjZShlLk5hbWUpCgkJZS5CYXNlVVJMID0gc3RyaW5ncy5UcmltU3BhY2Uo\nZS5CYXNlVVJMKQoJCWUuSGVhZGVycyA9IE5vcm1hbGl6ZUhlYWRlcnMoZS5I\nZWFkZXJzKQoJCWlmIGUuQmFzZVVSTCA9PSAiIiB7CgkJCS8vIFNraXAgcHJv\ndmlkZXJzIHdpdGggbm8gYmFzZS11cmw7IHRyZWF0ZWQgYXMgcmVtb3ZlZAoJ\nCQljb250aW51ZQoJCX0KCQlvdXQgPSBhcHBlbmQob3V0LCBlKQoJfQoJY2Zn\nLk9wZW5BSUNvbXBhdGliaWxpdHkgPSBvdXQKfQoKLy8gU2FuaXRpemVDb2Rl\neEtleXMgcmVtb3ZlcyBDb2RleCBBUEkga2V5IGVudHJpZXMgbWlzc2luZyBh\nIEJhc2VVUkwuCi8vIEl0IHRyaW1zIHdoaXRlc3BhY2UgYW5kIHByZXNlcnZl\ncyBvcmRlciBmb3IgcmVtYWluaW5nIGVudHJpZXMuCmZ1bmMgKGNmZyAqQ29u\nZmlnKSBTYW5pdGl6ZUNvZGV4S2V5cygpIHsKCWlmIGNmZyA9PSBuaWwgfHwg\nbGVuKGNmZy5Db2RleEtleSkgPT0gMCB7CgkJcmV0dXJuCgl9CglvdXQgOj0g\nbWFrZShbXUNvZGV4S2V5LCAwLCBsZW4oY2ZnLkNvZGV4S2V5KSkKCWZvciBp\nIDo9IHJhbmdlIGNmZy5Db2RleEtleSB7CgkJZSA6PSBjZmcuQ29kZXhLZXlb\naV0KCQllLkJhc2VVUkwgPSBzdHJpbmdzLlRyaW1TcGFjZShlLkJhc2VVUkwp\nCgkJZS5IZWFkZXJzID0gTm9ybWFsaXplSGVhZGVycyhlLkhlYWRlcnMpCgkJ\nZS5FeGNsdWRlZE1vZGVscyA9IE5vcm1hbGl6ZUV4Y2x1ZGVkTW9kZWxzKGUu\nRXhjbHVkZWRNb2RlbHMpCgkJaWYgZS5CYXNlVVJMID09ICIiIHsKCQkJY29u\ndGludWUKCQl9CgkJb3V0ID0gYXBwZW5kKG91dCwgZSkKCX0KCWNmZy5Db2Rl\neEtleSA9IG91dAp9CgovLyBTYW5pdGl6ZUNsYXVkZUtleXMgbm9ybWFsaXpl\ncyBoZWFkZXJzIGZvciBDbGF1ZGUgY3JlZGVudGlhbHMuCmZ1bmMgKGNmZyAq\nQ29uZmlnKSBTYW5pdGl6ZUNsYXVkZUtleXMoKSB7CglpZiBjZmcgPT0gbmls\nIHx8IGxlbihjZmcuQ2xhdWRlS2V5KSA9PSAwIHsKCQlyZXR1cm4KCX0KCWZv\nciBpIDo9IHJhbmdlIGNmZy5DbGF1ZGVLZXkgewoJCWVudHJ5IDo9ICZjZmcu\nQ2xhdWRlS2V5W2ldCgkJZW50cnkuSGVhZGVycyA9IE5vcm1hbGl6ZUhlYWRl\ncnMoZW50cnkuSGVhZGVycykKCQllbnRyeS5FeGNsdWRlZE1vZGVscyA9IE5v\ncm1hbGl6ZUV4Y2x1ZGVkTW9kZWxzKGVudHJ5LkV4Y2x1ZGVkTW9kZWxzKQoJ\nfQp9CgovLyBTYW5pdGl6ZUdlbWluaUtleXMgZGVkdXBsaWNhdGVzIGFuZCBu\nb3JtYWxpemVzIEdlbWluaSBjcmVkZW50aWFscy4KZnVuYyAoY2ZnICpDb25m\naWcpIFNhbml0aXplR2VtaW5pS2V5cygpIHsKCWlmIGNmZyA9PSBuaWwgewoJ\nCXJldHVybgoJfQoKCXNlZW4gOj0gbWFrZShtYXBbc3RyaW5nXXN0cnVjdHt9\nLCBsZW4oY2ZnLkdlbWluaUtleSkpCglvdXQgOj0gY2ZnLkdlbWluaUtleVs6\nMF0KCWZvciBpIDo9IHJhbmdlIGNmZy5HZW1pbmlLZXkgewoJCWVudHJ5IDo9\nIGNmZy5HZW1pbmlLZXlbaV0KCQllbnRyeS5BUElLZXkgPSBzdHJpbmdzLlRy\naW1TcGFjZShlbnRyeS5BUElLZXkpCgkJaWYgZW50cnkuQVBJS2V5ID09ICIi\nIHsKCQkJY29udGludWUKCQl9CgkJZW50cnkuQmFzZVVSTCA9IHN0cmluZ3Mu\nVHJpbVNwYWNlKGVudHJ5LkJhc2VVUkwpCgkJZW50cnkuUHJveHlVUkwgPSBz\ndHJpbmdzLlRyaW1TcGFjZShlbnRyeS5Qcm94eVVSTCkKCQllbnRyeS5IZWFk\nZXJzID0gTm9ybWFsaXplSGVhZGVycyhlbnRyeS5IZWFkZXJzKQoJCWVudHJ5\nLkV4Y2x1ZGVkTW9kZWxzID0gTm9ybWFsaXplRXhjbHVkZWRNb2RlbHMoZW50\ncnkuRXhjbHVkZWRNb2RlbHMpCgkJaWYgXywgZXhpc3RzIDo9IHNlZW5bZW50\ncnkuQVBJS2V5XTsgZXhpc3RzIHsKCQkJY29udGludWUKCQl9CgkJc2Vlbltl\nbnRyeS5BUElLZXldID0gc3RydWN0e317fQoJCW91dCA9IGFwcGVuZChvdXQs\nIGVudHJ5KQoJfQoJY2ZnLkdlbWluaUtleSA9IG91dAp9CgpmdW5jIHN5bmNJ\nbmxpbmVBY2Nlc3NQcm92aWRlcihjZmcgKkNvbmZpZykgewoJaWYgY2ZnID09\nIG5pbCB7CgkJcmV0dXJuCgl9CglpZiBsZW4oY2ZnLkFQSUtleXMpID09IDAg\newoJCWlmIHByb3ZpZGVyIDo9IGNmZy5Db25maWdBUElLZXlQcm92aWRlcigp\nOyBwcm92aWRlciAhPSBuaWwgJiYgbGVuKHByb3ZpZGVyLkFQSUtleXMpID4g\nMCB7CgkJCWNmZy5BUElLZXlzID0gYXBwZW5kKFtdc3RyaW5nKG5pbCksIHBy\nb3ZpZGVyLkFQSUtleXMuLi4pCgkJfQoJfQoJY2ZnLkFjY2Vzcy5Qcm92aWRl\ncnMgPSBuaWwKfQoKLy8gbG9va3NMaWtlQmNyeXB0IHJldHVybnMgdHJ1ZSBp\nZiB0aGUgcHJvdmlkZWQgc3RyaW5nIGFwcGVhcnMgdG8gYmUgYSBiY3J5cHQg\naGFzaC4KZnVuYyBsb29rc0xpa2VCY3J5cHQocyBzdHJpbmcpIGJvb2wgewoJ\ncmV0dXJuIGxlbihzKSA+IDQgJiYgKHNbOjRdID09ICIkMmEkIiB8fCBzWzo0\nXSA9PSAiJDJiJCIgfHwgc1s6NF0gPT0gIiQyeSQiKQp9CgovLyBOb3JtYWxp\nemVIZWFkZXJzIHRyaW1zIGhlYWRlciBrZXlzIGFuZCB2YWx1ZXMgYW5kIHJl\nbW92ZXMgZW1wdHkgcGFpcnMuCmZ1bmMgTm9ybWFsaXplSGVhZGVycyhoZWFk\nZXJzIG1hcFtzdHJpbmddc3RyaW5nKSBtYXBbc3RyaW5nXXN0cmluZyB7Cglp\nZiBsZW4oaGVhZGVycykgPT0gMCB7CgkJcmV0dXJuIG5pbAoJfQoJY2xlYW4g\nOj0gbWFrZShtYXBbc3RyaW5nXXN0cmluZywgbGVuKGhlYWRlcnMpKQoJZm9y\nIGssIHYgOj0gcmFuZ2UgaGVhZGVycyB7CgkJa2V5IDo9IHN0cmluZ3MuVHJp\nbVNwYWNlKGspCgkJdmFsIDo9IHN0cmluZ3MuVHJpbVNwYWNlKHYpCgkJaWYg\na2V5ID09ICIiIHx8IHZhbCA9PSAiIiB7CgkJCWNvbnRpbnVlCgkJfQoJCWNs\nZWFuW2tleV0gPSB2YWwKCX0KCWlmIGxlbihjbGVhbikgPT0gMCB7CgkJcmV0\ndXJuIG5pbAoJfQoJcmV0dXJuIGNsZWFuCn0KCi8vIE5vcm1hbGl6ZUV4Y2x1\nZGVkTW9kZWxzIHRyaW1zLCBsb3dlcmNhc2VzLCBhbmQgZGVkdXBsaWNhdGVz\nIG1vZGVsIGV4Y2x1c2lvbiBwYXR0ZXJucy4KLy8gSXQgcHJlc2VydmVzIHRo\nZSBvcmRlciBvZiBmaXJzdCBvY2N1cnJlbmNlcyBhbmQgZHJvcHMgZW1wdHkg\nZW50cmllcy4KZnVuYyBOb3JtYWxpemVFeGNsdWRlZE1vZGVscyhtb2RlbHMg\nW11zdHJpbmcpIFtdc3RyaW5nIHsKCWlmIGxlbihtb2RlbHMpID09IDAgewoJ\nCXJldHVybiBuaWwKCX0KCXNlZW4gOj0gbWFrZShtYXBbc3RyaW5nXXN0cnVj\ndHt9LCBsZW4obW9kZWxzKSkKCW91dCA6PSBtYWtlKFtdc3RyaW5nLCAwLCBs\nZW4obW9kZWxzKSkKCWZvciBfLCByYXcgOj0gcmFuZ2UgbW9kZWxzIHsKCQl0\ncmltbWVkIDo9IHN0cmluZ3MuVG9Mb3dlcihzdHJpbmdzLlRyaW1TcGFjZShy\nYXcpKQoJCWlmIHRyaW1tZWQgPT0gIiIgewoJCQljb250aW51ZQoJCX0KCQlp\nZiBfLCBleGlzdHMgOj0gc2Vlblt0cmltbWVkXTsgZXhpc3RzIHsKCQkJY29u\ndGludWUKCQl9CgkJc2Vlblt0cmltbWVkXSA9IHN0cnVjdHt9e30KCQlvdXQg\nPSBhcHBlbmQob3V0LCB0cmltbWVkKQoJfQoJaWYgbGVuKG91dCkgPT0gMCB7\nCgkJcmV0dXJuIG5pbAoJfQoJcmV0dXJuIG91dAp9CgovLyBOb3JtYWxpemVP\nQXV0aEV4Y2x1ZGVkTW9kZWxzIGNsZWFucyBwcm92aWRlciAtPiBleGNsdWRl\nZCBtb2RlbHMgbWFwcGluZ3MgYnkgbm9ybWFsaXppbmcgcHJvdmlkZXIga2V5\ncwovLyBhbmQgYXBwbHlpbmcgbW9kZWwgZXhjbHVzaW9uIG5vcm1hbGl6YXRp\nb24gdG8gZWFjaCBlbnRyeS4KZnVuYyBOb3JtYWxpemVPQXV0aEV4Y2x1ZGVk\nTW9kZWxzKGVudHJpZXMgbWFwW3N0cmluZ11bXXN0cmluZykgbWFwW3N0cmlu\nZ11bXXN0cmluZyB7CglpZiBsZW4oZW50cmllcykgPT0gMCB7CgkJcmV0dXJu\nIG5pbAoJfQoJb3V0IDo9IG1ha2UobWFwW3N0cmluZ11bXXN0cmluZywgbGVu\nKGVudHJpZXMpKQoJZm9yIHByb3ZpZGVyLCBtb2RlbHMgOj0gcmFuZ2UgZW50\ncmllcyB7CgkJa2V5IDo9IHN0cmluZ3MuVG9Mb3dlcihzdHJpbmdzLlRyaW1T\ncGFjZShwcm92aWRlcikpCgkJaWYga2V5ID09ICIiIHsKCQkJY29udGludWUK\nCQl9CgkJbm9ybWFsaXplZCA6PSBOb3JtYWxpemVFeGNsdWRlZE1vZGVscyht\nb2RlbHMpCgkJaWYgbGVuKG5vcm1hbGl6ZWQpID09IDAgewoJCQljb250aW51\nZQoJCX0KCQlvdXRba2V5XSA9IG5vcm1hbGl6ZWQKCX0KCWlmIGxlbihvdXQp\nID09IDAgewoJCXJldHVybiBuaWwKCX0KCXJldHVybiBvdXQKfQoKLy8gaGFz\naFNlY3JldCBoYXNoZXMgdGhlIGdpdmVuIHNlY3JldCB1c2luZyBiY3J5cHQu\nCmZ1bmMgaGFzaFNlY3JldChzZWNyZXQgc3RyaW5nKSAoc3RyaW5nLCBlcnJv\ncikgewoJLy8gVXNlIGRlZmF1bHQgY29zdCBmb3Igc2ltcGxpY2l0eS4KCWhh\nc2hlZEJ5dGVzLCBlcnIgOj0gYmNyeXB0LkdlbmVyYXRlRnJvbVBhc3N3b3Jk\nKFtdYnl0ZShzZWNyZXQpLCBiY3J5cHQuRGVmYXVsdENvc3QpCglpZiBlcnIg\nIT0gbmlsIHsKCQlyZXR1cm4gIiIsIGVycgoJfQoJcmV0dXJuIHN0cmluZyho\nYXNoZWRCeXRlcyksIG5pbAp9CgovLyBTYXZlQ29uZmlnUHJlc2VydmVDb21t\nZW50cyB3cml0ZXMgdGhlIGNvbmZpZyBiYWNrIHRvIFlBTUwgd2hpbGUgcHJl\nc2VydmluZyBleGlzdGluZyBjb21tZW50cwovLyBhbmQga2V5IG9yZGVyaW5n\nIGJ5IGxvYWRpbmcgdGhlIG9yaWdpbmFsIGZpbGUgaW50byBhIHlhbWwuTm9k\nZSB0cmVlIGFuZCB1cGRhdGluZyB2YWx1ZXMgaW4tcGxhY2UuCmZ1bmMgU2F2\nZUNvbmZpZ1ByZXNlcnZlQ29tbWVudHMoY29uZmlnRmlsZSBzdHJpbmcsIGNm\nZyAqQ29uZmlnKSBlcnJvciB7CglwZXJzaXN0Q2ZnIDo9IHNhbml0aXplQ29u\nZmlnRm9yUGVyc2lzdChjZmcpCgkvLyBMb2FkIG9yaWdpbmFsIFlBTUwgYXMg\nYSBub2RlIHRyZWUgdG8gcHJlc2VydmUgY29tbWVudHMgYW5kIG9yZGVyaW5n\nLgoJZGF0YSwgZXJyIDo9IG9zLlJlYWRGaWxlKGNvbmZpZ0ZpbGUpCglpZiBl\ncnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9CgoJdmFyIG9yaWdpbmFsIHlh\nbWwuTm9kZQoJaWYgZXJyID0geWFtbC5Vbm1hcnNoYWwoZGF0YSwgJm9yaWdp\nbmFsKTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJaWYgb3JpZ2lu\nYWwuS2luZCAhPSB5YW1sLkRvY3VtZW50Tm9kZSB8fCBsZW4ob3JpZ2luYWwu\nQ29udGVudCkgPT0gMCB7CgkJcmV0dXJuIGZtdC5FcnJvcmYoImludmFsaWQg\neWFtbCBkb2N1bWVudCBzdHJ1Y3R1cmUiKQoJfQoJaWYgb3JpZ2luYWwuQ29u\ndGVudFswXSA9PSBuaWwgfHwgb3JpZ2luYWwuQ29udGVudFswXS5LaW5kICE9\nIHlhbWwuTWFwcGluZ05vZGUgewoJCXJldHVybiBmbXQuRXJyb3JmKCJleHBl\nY3RlZCByb290IG1hcHBpbmcgbm9kZSIpCgl9CgoJLy8gTWFyc2hhbCB0aGUg\nY3VycmVudCBjZmcgdG8gWUFNTCwgdGhlbiB1bm1hcnNoYWwgdG8gYSB5YW1s\nLk5vZGUgd2UgY2FuIG1lcmdlIGZyb20uCglyZW5kZXJlZCwgZXJyIDo9IHlh\nbWwuTWFyc2hhbChwZXJzaXN0Q2ZnKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0\ndXJuIGVycgoJfQoJdmFyIGdlbmVyYXRlZCB5YW1sLk5vZGUKCWlmIGVyciA9\nIHlhbWwuVW5tYXJzaGFsKHJlbmRlcmVkLCAmZ2VuZXJhdGVkKTsgZXJyICE9\nIG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJaWYgZ2VuZXJhdGVkLktpbmQgIT0g\neWFtbC5Eb2N1bWVudE5vZGUgfHwgbGVuKGdlbmVyYXRlZC5Db250ZW50KSA9\nPSAwIHx8IGdlbmVyYXRlZC5Db250ZW50WzBdID09IG5pbCB7CgkJcmV0dXJu\nIGZtdC5FcnJvcmYoImludmFsaWQgZ2VuZXJhdGVkIHlhbWwgc3RydWN0dXJl\nIikKCX0KCWlmIGdlbmVyYXRlZC5Db250ZW50WzBdLktpbmQgIT0geWFtbC5N\nYXBwaW5nTm9kZSB7CgkJcmV0dXJuIGZtdC5FcnJvcmYoImV4cGVjdGVkIGdl\nbmVyYXRlZCByb290IG1hcHBpbmcgbm9kZSIpCgl9CgoJLy8gUmVtb3ZlIGRl\ncHJlY2F0ZWQgc2VjdGlvbnMgYmVmb3JlIG1lcmdpbmcgYmFjayB0aGUgc2Fu\naXRpemVkIGNvbmZpZy4KCXJlbW92ZUxlZ2FjeUF1dGhCbG9jayhvcmlnaW5h\nbC5Db250ZW50WzBdKQoJcmVtb3ZlTGVnYWN5T3BlbkFJQ29tcGF0QVBJS2V5\ncyhvcmlnaW5hbC5Db250ZW50WzBdKQoJcmVtb3ZlTGVnYWN5QW1wS2V5cyhv\ncmlnaW5hbC5Db250ZW50WzBdKQoJcmVtb3ZlTGVnYWN5R2VuZXJhdGl2ZUxh\nbmd1YWdlS2V5cyhvcmlnaW5hbC5Db250ZW50WzBdKQoKCXBydW5lTWFwcGlu\nZ1RvR2VuZXJhdGVkS2V5cyhvcmlnaW5hbC5Db250ZW50WzBdLCBnZW5lcmF0\nZWQuQ29udGVudFswXSwgIm9hdXRoLWV4Y2x1ZGVkLW1vZGVscyIpCgoJLy8g\nTWVyZ2UgZ2VuZXJhdGVkIGludG8gb3JpZ2luYWwgaW4tcGxhY2UsIHByZXNl\ncnZpbmcgY29tbWVudHMvb3JkZXIgb2YgZXhpc3Rpbmcgbm9kZXMuCgltZXJn\nZU1hcHBpbmdQcmVzZXJ2ZShvcmlnaW5hbC5Db250ZW50WzBdLCBnZW5lcmF0\nZWQuQ29udGVudFswXSkKCW5vcm1hbGl6ZUNvbGxlY3Rpb25Ob2RlU3R5bGVz\nKG9yaWdpbmFsLkNvbnRlbnRbMF0pCgoJLy8gV3JpdGUgYmFjay4KCWYsIGVy\nciA6PSBvcy5DcmVhdGUoY29uZmlnRmlsZSkKCWlmIGVyciAhPSBuaWwgewoJ\nCXJldHVybiBlcnIKCX0KCWRlZmVyIGZ1bmMoKSB7IF8gPSBmLkNsb3NlKCkg\nfSgpCgl2YXIgYnVmIGJ5dGVzLkJ1ZmZlcgoJZW5jIDo9IHlhbWwuTmV3RW5j\nb2RlcigmYnVmKQoJZW5jLlNldEluZGVudCgyKQoJaWYgZXJyID0gZW5jLkVu\nY29kZSgmb3JpZ2luYWwpOyBlcnIgIT0gbmlsIHsKCQlfID0gZW5jLkNsb3Nl\nKCkKCQlyZXR1cm4gZXJyCgl9CglpZiBlcnIgPSBlbmMuQ2xvc2UoKTsgZXJy\nICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJZGF0YSA9IE5vcm1hbGl6ZUNv\nbW1lbnRJbmRlbnRhdGlvbihidWYuQnl0ZXMoKSkKCV8sIGVyciA9IGYuV3Jp\ndGUoZGF0YSkKCXJldHVybiBlcnIKfQoKZnVuYyBzYW5pdGl6ZUNvbmZpZ0Zv\nclBlcnNpc3QoY2ZnICpDb25maWcpICpDb25maWcgewoJaWYgY2ZnID09IG5p\nbCB7CgkJcmV0dXJuIG5pbAoJfQoJY2xvbmUgOj0gKmNmZwoJY2xvbmUuU0RL\nQ29uZmlnID0gY2ZnLlNES0NvbmZpZwoJY2xvbmUuU0RLQ29uZmlnLkFjY2Vz\ncyA9IGNvbmZpZy5BY2Nlc3NDb25maWd7fQoJcmV0dXJuICZjbG9uZQp9Cgov\nLyBTYXZlQ29uZmlnUHJlc2VydmVDb21tZW50c1VwZGF0ZU5lc3RlZFNjYWxh\nciB1cGRhdGVzIGEgbmVzdGVkIHNjYWxhciBrZXkgcGF0aCBsaWtlIFsiYSIs\nImIiXQovLyB3aGlsZSBwcmVzZXJ2aW5nIGNvbW1lbnRzIGFuZCBwb3NpdGlv\nbnMuCmZ1bmMgU2F2ZUNvbmZpZ1ByZXNlcnZlQ29tbWVudHNVcGRhdGVOZXN0\nZWRTY2FsYXIoY29uZmlnRmlsZSBzdHJpbmcsIHBhdGggW11zdHJpbmcsIHZh\nbHVlIHN0cmluZykgZXJyb3IgewoJZGF0YSwgZXJyIDo9IG9zLlJlYWRGaWxl\nKGNvbmZpZ0ZpbGUpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9\nCgl2YXIgcm9vdCB5YW1sLk5vZGUKCWlmIGVyciA9IHlhbWwuVW5tYXJzaGFs\nKGRhdGEsICZyb290KTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJ\naWYgcm9vdC5LaW5kICE9IHlhbWwuRG9jdW1lbnROb2RlIHx8IGxlbihyb290\nLkNvbnRlbnQpID09IDAgewoJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlk\nIHlhbWwgZG9jdW1lbnQgc3RydWN0dXJlIikKCX0KCW5vZGUgOj0gcm9vdC5D\nb250ZW50WzBdCgkvLyBkZXNjZW5kIG1hcHBpbmcgbm9kZXMgZm9sbG93aW5n\nIHBhdGgKCWZvciBpLCBrZXkgOj0gcmFuZ2UgcGF0aCB7CgkJaWYgaSA9PSBs\nZW4ocGF0aCktMSB7CgkJCS8vIHNldCBmaW5hbCBzY2FsYXIKCQkJdiA6PSBn\nZXRPckNyZWF0ZU1hcFZhbHVlKG5vZGUsIGtleSkKCQkJdi5LaW5kID0geWFt\nbC5TY2FsYXJOb2RlCgkJCXYuVGFnID0gIiEhc3RyIgoJCQl2LlZhbHVlID0g\ndmFsdWUKCQl9IGVsc2UgewoJCQluZXh0IDo9IGdldE9yQ3JlYXRlTWFwVmFs\ndWUobm9kZSwga2V5KQoJCQlpZiBuZXh0LktpbmQgIT0geWFtbC5NYXBwaW5n\nTm9kZSB7CgkJCQluZXh0LktpbmQgPSB5YW1sLk1hcHBpbmdOb2RlCgkJCQlu\nZXh0LlRhZyA9ICIhIW1hcCIKCQkJfQoJCQlub2RlID0gbmV4dAoJCX0KCX0K\nCWYsIGVyciA6PSBvcy5DcmVhdGUoY29uZmlnRmlsZSkKCWlmIGVyciAhPSBu\naWwgewoJCXJldHVybiBlcnIKCX0KCWRlZmVyIGZ1bmMoKSB7IF8gPSBmLkNs\nb3NlKCkgfSgpCgl2YXIgYnVmIGJ5dGVzLkJ1ZmZlcgoJZW5jIDo9IHlhbWwu\nTmV3RW5jb2RlcigmYnVmKQoJZW5jLlNldEluZGVudCgyKQoJaWYgZXJyID0g\nZW5jLkVuY29kZSgmcm9vdCk7IGVyciAhPSBuaWwgewoJCV8gPSBlbmMuQ2xv\nc2UoKQoJCXJldHVybiBlcnIKCX0KCWlmIGVyciA9IGVuYy5DbG9zZSgpOyBl\ncnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9CglkYXRhID0gTm9ybWFsaXpl\nQ29tbWVudEluZGVudGF0aW9uKGJ1Zi5CeXRlcygpKQoJXywgZXJyID0gZi5X\ncml0ZShkYXRhKQoJcmV0dXJuIGVycgp9CgovLyBOb3JtYWxpemVDb21tZW50\nSW5kZW50YXRpb24gcmVtb3ZlcyBpbmRlbnRhdGlvbiBmcm9tIHN0YW5kYWxv\nbmUgWUFNTCBjb21tZW50IGxpbmVzIHRvIGtlZXAgdGhlbSBsZWZ0IGFsaWdu\nZWQuCmZ1bmMgTm9ybWFsaXplQ29tbWVudEluZGVudGF0aW9uKGRhdGEgW11i\neXRlKSBbXWJ5dGUgewoJbGluZXMgOj0gYnl0ZXMuU3BsaXQoZGF0YSwgW11i\neXRlKCJcbiIpKQoJY2hhbmdlZCA6PSBmYWxzZQoJZm9yIGksIGxpbmUgOj0g\ncmFuZ2UgbGluZXMgewoJCXRyaW1tZWQgOj0gYnl0ZXMuVHJpbUxlZnQobGlu\nZSwgIiBcdCIpCgkJaWYgbGVuKHRyaW1tZWQpID09IDAgfHwgdHJpbW1lZFsw\nXSAhPSAnIycgewoJCQljb250aW51ZQoJCX0KCQlpZiBsZW4odHJpbW1lZCkg\nPT0gbGVuKGxpbmUpIHsKCQkJY29udGludWUKCQl9CgkJbGluZXNbaV0gPSBh\ncHBlbmQoW11ieXRlKG5pbCksIHRyaW1tZWQuLi4pCgkJY2hhbmdlZCA9IHRy\ndWUKCX0KCWlmICFjaGFuZ2VkIHsKCQlyZXR1cm4gZGF0YQoJfQoJcmV0dXJu\nIGJ5dGVzLkpvaW4obGluZXMsIFtdYnl0ZSgiXG4iKSkKfQoKLy8gZ2V0T3JD\ncmVhdGVNYXBWYWx1ZSBmaW5kcyB0aGUgdmFsdWUgbm9kZSBmb3IgYSBnaXZl\nbiBrZXkgaW4gYSBtYXBwaW5nIG5vZGUuCi8vIElmIG5vdCBmb3VuZCwgaXQg\nYXBwZW5kcyBhIG5ldyBrZXkvdmFsdWUgcGFpciBhbmQgcmV0dXJucyB0aGUg\nbmV3IHZhbHVlIG5vZGUuCmZ1bmMgZ2V0T3JDcmVhdGVNYXBWYWx1ZShtYXBO\nb2RlICp5YW1sLk5vZGUsIGtleSBzdHJpbmcpICp5YW1sLk5vZGUgewoJaWYg\nbWFwTm9kZS5LaW5kICE9IHlhbWwuTWFwcGluZ05vZGUgewoJCW1hcE5vZGUu\nS2luZCA9IHlhbWwuTWFwcGluZ05vZGUKCQltYXBOb2RlLlRhZyA9ICIhIW1h\ncCIKCQltYXBOb2RlLkNvbnRlbnQgPSBuaWwKCX0KCWZvciBpIDo9IDA7IGkr\nMSA8IGxlbihtYXBOb2RlLkNvbnRlbnQpOyBpICs9IDIgewoJCWsgOj0gbWFw\nTm9kZS5Db250ZW50W2ldCgkJaWYgay5WYWx1ZSA9PSBrZXkgewoJCQlyZXR1\ncm4gbWFwTm9kZS5Db250ZW50W2krMV0KCQl9Cgl9CgkvLyBhcHBlbmQgbmV3\nIGtleS92YWx1ZQoJbWFwTm9kZS5Db250ZW50ID0gYXBwZW5kKG1hcE5vZGUu\nQ29udGVudCwgJnlhbWwuTm9kZXtLaW5kOiB5YW1sLlNjYWxhck5vZGUsIFRh\nZzogIiEhc3RyIiwgVmFsdWU6IGtleX0pCgl2YWwgOj0gJnlhbWwuTm9kZXtL\naW5kOiB5YW1sLlNjYWxhck5vZGUsIFRhZzogIiEhc3RyIiwgVmFsdWU6ICIi\nfQoJbWFwTm9kZS5Db250ZW50ID0gYXBwZW5kKG1hcE5vZGUuQ29udGVudCwg\ndmFsKQoJcmV0dXJuIHZhbAp9CgovLyBtZXJnZU1hcHBpbmdQcmVzZXJ2ZSBt\nZXJnZXMga2V5cyBmcm9tIHNyYyBpbnRvIGRzdCBtYXBwaW5nIG5vZGUgd2hp\nbGUgcHJlc2VydmluZwovLyBrZXkgb3JkZXIgYW5kIGNvbW1lbnRzIG9mIGV4\naXN0aW5nIGtleXMgaW4gZHN0LiBVbmtub3duIGtleXMgZnJvbSBzcmMgYXJl\nIGFwcGVuZGVkCi8vIHRvIGRzdCBhdCB0aGUgZW5kLCBjb3B5aW5nIHRoZWly\nIG5vZGUgc3RydWN0dXJlIGZyb20gc3JjLgpmdW5jIG1lcmdlTWFwcGluZ1By\nZXNlcnZlKGRzdCwgc3JjICp5YW1sLk5vZGUpIHsKCWlmIGRzdCA9PSBuaWwg\nfHwgc3JjID09IG5pbCB7CgkJcmV0dXJuCgl9CglpZiBkc3QuS2luZCAhPSB5\nYW1sLk1hcHBpbmdOb2RlIHx8IHNyYy5LaW5kICE9IHlhbWwuTWFwcGluZ05v\nZGUgewoJCS8vIElmIGtpbmRzIGRvIG5vdCBtYXRjaCwgcHJlZmVyIHJlcGxh\nY2luZyBkc3Qgd2l0aCBzcmMgc2VtYW50aWNzIGluLXBsYWNlCgkJLy8gYnV0\nIGtlZXAgZHN0IG5vZGUgb2JqZWN0IHRvIHByZXNlcnZlIGFueSBhdHRhY2hl\nZCBjb21tZW50cyBhdCB0aGUgcGFyZW50IGxldmVsLgoJCWNvcHlOb2RlU2hh\nbGxvdyhkc3QsIHNyYykKCQlyZXR1cm4KCX0KCS8vIEJ1aWxkIGEgbG9va3Vw\nIG9mIGV4aXN0aW5nIGtleXMgaW4gZHN0Cglmb3IgaSA6PSAwOyBpKzEgPCBs\nZW4oc3JjLkNvbnRlbnQpOyBpICs9IDIgewoJCXNrIDo9IHNyYy5Db250ZW50\nW2ldCgkJc3YgOj0gc3JjLkNvbnRlbnRbaSsxXQoJCWlkeCA6PSBmaW5kTWFw\nS2V5SW5kZXgoZHN0LCBzay5WYWx1ZSkKCQlpZiBpZHggPj0gMCB7CgkJCS8v\nIE1lcmdlIGludG8gZXhpc3RpbmcgdmFsdWUgbm9kZQoJCQlkdiA6PSBkc3Qu\nQ29udGVudFtpZHgrMV0KCQkJbWVyZ2VOb2RlUHJlc2VydmUoZHYsIHN2KQoJ\nCX0gZWxzZSB7CgkJCWlmIHNob3VsZFNraXBFbXB0eUNvbGxlY3Rpb25PblBl\ncnNpc3Qoc2suVmFsdWUsIHN2KSB7CgkJCQljb250aW51ZQoJCQl9CgkJCS8v\nIEFwcGVuZCBuZXcga2V5L3ZhbHVlIHBhaXIgYnkgZGVlcC1jb3B5aW5nIGZy\nb20gc3JjCgkJCWRzdC5Db250ZW50ID0gYXBwZW5kKGRzdC5Db250ZW50LCBk\nZWVwQ29weU5vZGUoc2spLCBkZWVwQ29weU5vZGUoc3YpKQoJCX0KCX0KfQoK\nLy8gbWVyZ2VOb2RlUHJlc2VydmUgbWVyZ2VzIHNyYyBpbnRvIGRzdCBmb3Ig\nc2NhbGFycywgbWFwcGluZ3MgYW5kIHNlcXVlbmNlcyB3aGlsZQovLyByZXVz\naW5nIGRlc3RpbmF0aW9uIG5vZGVzIHRvIGtlZXAgY29tbWVudHMgYW5kIGFu\nY2hvcnMuIEZvciBzZXF1ZW5jZXMsIGl0IHVwZGF0ZXMKLy8gaW4tcGxhY2Ug\nYnkgaW5kZXguCmZ1bmMgbWVyZ2VOb2RlUHJlc2VydmUoZHN0LCBzcmMgKnlh\nbWwuTm9kZSkgewoJaWYgZHN0ID09IG5pbCB8fCBzcmMgPT0gbmlsIHsKCQly\nZXR1cm4KCX0KCXN3aXRjaCBzcmMuS2luZCB7CgljYXNlIHlhbWwuTWFwcGlu\nZ05vZGU6CgkJaWYgZHN0LktpbmQgIT0geWFtbC5NYXBwaW5nTm9kZSB7CgkJ\nCWNvcHlOb2RlU2hhbGxvdyhkc3QsIHNyYykKCQl9CgkJbWVyZ2VNYXBwaW5n\nUHJlc2VydmUoZHN0LCBzcmMpCgljYXNlIHlhbWwuU2VxdWVuY2VOb2RlOgoJ\nCS8vIFByZXNlcnZlIGV4cGxpY2l0IG51bGwgc3R5bGUgaWYgZHN0IHdhcyBu\ndWxsIGFuZCBzcmMgaXMgZW1wdHkgc2VxdWVuY2UKCQlpZiBkc3QuS2luZCA9\nPSB5YW1sLlNjYWxhck5vZGUgJiYgZHN0LlRhZyA9PSAiISFudWxsIiAmJiBs\nZW4oc3JjLkNvbnRlbnQpID09IDAgewoJCQkvLyBLZWVwIGFzIG51bGwgdG8g\ncHJlc2VydmUgb3JpZ2luYWwgc3R5bGUKCQkJcmV0dXJuCgkJfQoJCWlmIGRz\ndC5LaW5kICE9IHlhbWwuU2VxdWVuY2VOb2RlIHsKCQkJZHN0LktpbmQgPSB5\nYW1sLlNlcXVlbmNlTm9kZQoJCQlkc3QuVGFnID0gIiEhc2VxIgoJCQlkc3Qu\nQ29udGVudCA9IG5pbAoJCX0KCQlyZW9yZGVyU2VxdWVuY2VGb3JNZXJnZShk\nc3QsIHNyYykKCQkvLyBVcGRhdGUgZWxlbWVudHMgaW4gcGxhY2UKCQltaW5D\nb250ZW50IDo9IGxlbihkc3QuQ29udGVudCkKCQlpZiBsZW4oc3JjLkNvbnRl\nbnQpIDwgbWluQ29udGVudCB7CgkJCW1pbkNvbnRlbnQgPSBsZW4oc3JjLkNv\nbnRlbnQpCgkJfQoJCWZvciBpIDo9IDA7IGkgPCBtaW5Db250ZW50OyBpKysg\newoJCQlpZiBkc3QuQ29udGVudFtpXSA9PSBuaWwgewoJCQkJZHN0LkNvbnRl\nbnRbaV0gPSBkZWVwQ29weU5vZGUoc3JjLkNvbnRlbnRbaV0pCgkJCQljb250\naW51ZQoJCQl9CgkJCW1lcmdlTm9kZVByZXNlcnZlKGRzdC5Db250ZW50W2ld\nLCBzcmMuQ29udGVudFtpXSkKCQkJaWYgZHN0LkNvbnRlbnRbaV0gIT0gbmls\nICYmIHNyYy5Db250ZW50W2ldICE9IG5pbCAmJgoJCQkJZHN0LkNvbnRlbnRb\naV0uS2luZCA9PSB5YW1sLk1hcHBpbmdOb2RlICYmIHNyYy5Db250ZW50W2ld\nLktpbmQgPT0geWFtbC5NYXBwaW5nTm9kZSB7CgkJCQlwcnVuZU1pc3NpbmdN\nYXBLZXlzKGRzdC5Db250ZW50W2ldLCBzcmMuQ29udGVudFtpXSkKCQkJfQoJ\nCX0KCQkvLyBBcHBlbmQgYW55IGV4dHJhIGl0ZW1zIGZyb20gc3JjCgkJZm9y\nIGkgOj0gbGVuKGRzdC5Db250ZW50KTsgaSA8IGxlbihzcmMuQ29udGVudCk7\nIGkrKyB7CgkJCWRzdC5Db250ZW50ID0gYXBwZW5kKGRzdC5Db250ZW50LCBk\nZWVwQ29weU5vZGUoc3JjLkNvbnRlbnRbaV0pKQoJCX0KCQkvLyBUcnVuY2F0\nZSBpZiBkc3QgaGFzIGV4dHJhIGl0ZW1zIG5vdCBpbiBzcmMKCQlpZiBsZW4o\nc3JjLkNvbnRlbnQpIDwgbGVuKGRzdC5Db250ZW50KSB7CgkJCWRzdC5Db250\nZW50ID0gZHN0LkNvbnRlbnRbOmxlbihzcmMuQ29udGVudCldCgkJfQoJY2Fz\nZSB5YW1sLlNjYWxhck5vZGUsIHlhbWwuQWxpYXNOb2RlOgoJCS8vIEZvciBz\nY2FsYXJzLCB1cGRhdGUgVGFnIGFuZCBWYWx1ZSBidXQga2VlcCBTdHlsZSBm\ncm9tIGRzdCB0byBwcmVzZXJ2ZSBxdW90aW5nCgkJZHN0LktpbmQgPSBzcmMu\nS2luZAoJCWRzdC5UYWcgPSBzcmMuVGFnCgkJZHN0LlZhbHVlID0gc3JjLlZh\nbHVlCgkJLy8gS2VlcCBkc3QuU3R5bGUgYXMtaXMgaW50ZW50aW9uYWxseQoJ\nY2FzZSAwOgoJCS8vIFVua25vd24vZW1wdHkga2luZDsgZG8gbm90aGluZwoJ\nZGVmYXVsdDoKCQkvLyBGYWxsYmFjazogcmVwbGFjZSBzaGFsbG93bHkKCQlj\nb3B5Tm9kZVNoYWxsb3coZHN0LCBzcmMpCgl9Cn0KCi8vIGZpbmRNYXBLZXlJ\nbmRleCByZXR1cm5zIHRoZSBpbmRleCBvZiBrZXkgbm9kZSBpbiBkc3QgbWFw\ncGluZyAoaW5kZXggb2Yga2V5LCBub3QgdmFsdWUpLgovLyBSZXR1cm5zIC0x\nIHdoZW4gbm90IGZvdW5kLgpmdW5jIGZpbmRNYXBLZXlJbmRleChtYXBOb2Rl\nICp5YW1sLk5vZGUsIGtleSBzdHJpbmcpIGludCB7CglpZiBtYXBOb2RlID09\nIG5pbCB8fCBtYXBOb2RlLktpbmQgIT0geWFtbC5NYXBwaW5nTm9kZSB7CgkJ\ncmV0dXJuIC0xCgl9Cglmb3IgaSA6PSAwOyBpKzEgPCBsZW4obWFwTm9kZS5D\nb250ZW50KTsgaSArPSAyIHsKCQlpZiBtYXBOb2RlLkNvbnRlbnRbaV0gIT0g\nbmlsICYmIG1hcE5vZGUuQ29udGVudFtpXS5WYWx1ZSA9PSBrZXkgewoJCQly\nZXR1cm4gaQoJCX0KCX0KCXJldHVybiAtMQp9CgpmdW5jIHNob3VsZFNraXBF\nbXB0eUNvbGxlY3Rpb25PblBlcnNpc3Qoa2V5IHN0cmluZywgbm9kZSAqeWFt\nbC5Ob2RlKSBib29sIHsKCXN3aXRjaCBrZXkgewoJY2FzZSAiZ2VuZXJhdGl2\nZS1sYW5ndWFnZS1hcGkta2V5IiwKCQkiZ2VtaW5pLWFwaS1rZXkiLAoJCSJ2\nZXJ0ZXgtYXBpLWtleSIsCgkJImNsYXVkZS1hcGkta2V5IiwKCQkiY29kZXgt\nYXBpLWtleSIsCgkJIm9wZW5haS1jb21wYXRpYmlsaXR5IjoKCQlyZXR1cm4g\naXNFbXB0eUNvbGxlY3Rpb25Ob2RlKG5vZGUpCglkZWZhdWx0OgoJCXJldHVy\nbiBmYWxzZQoJfQp9CgpmdW5jIGlzRW1wdHlDb2xsZWN0aW9uTm9kZShub2Rl\nICp5YW1sLk5vZGUpIGJvb2wgewoJaWYgbm9kZSA9PSBuaWwgewoJCXJldHVy\nbiB0cnVlCgl9Cglzd2l0Y2ggbm9kZS5LaW5kIHsKCWNhc2UgeWFtbC5TZXF1\nZW5jZU5vZGU6CgkJcmV0dXJuIGxlbihub2RlLkNvbnRlbnQpID09IDAKCWNh\nc2UgeWFtbC5TY2FsYXJOb2RlOgoJCXJldHVybiBub2RlLlRhZyA9PSAiISFu\ndWxsIgoJZGVmYXVsdDoKCQlyZXR1cm4gZmFsc2UKCX0KfQoKLy8gZGVlcENv\ncHlOb2RlIGNyZWF0ZXMgYSBkZWVwIGNvcHkgb2YgYSB5YW1sLk5vZGUgZ3Jh\ncGguCmZ1bmMgZGVlcENvcHlOb2RlKG4gKnlhbWwuTm9kZSkgKnlhbWwuTm9k\nZSB7CglpZiBuID09IG5pbCB7CgkJcmV0dXJuIG5pbAoJfQoJY3AgOj0gKm4K\nCWlmIGxlbihuLkNvbnRlbnQpID4gMCB7CgkJY3AuQ29udGVudCA9IG1ha2Uo\nW10qeWFtbC5Ob2RlLCBsZW4obi5Db250ZW50KSkKCQlmb3IgaSA6PSByYW5n\nZSBuLkNvbnRlbnQgewoJCQljcC5Db250ZW50W2ldID0gZGVlcENvcHlOb2Rl\nKG4uQ29udGVudFtpXSkKCQl9Cgl9CglyZXR1cm4gJmNwCn0KCi8vIGNvcHlO\nb2RlU2hhbGxvdyBjb3BpZXMgdHlwZS90YWcvdmFsdWUgYW5kIHJlc2V0cyBj\nb250ZW50IHRvIG1hdGNoIHNyYywgYnV0Ci8vIGtlZXBzIHRoZSBzYW1lIGRl\nc3RpbmF0aW9uIG5vZGUgcG9pbnRlciB0byBwcmVzZXJ2ZSBwYXJlbnQgcmVs\nYXRpb25zL2NvbW1lbnRzLgpmdW5jIGNvcHlOb2RlU2hhbGxvdyhkc3QsIHNy\nYyAqeWFtbC5Ob2RlKSB7CglpZiBkc3QgPT0gbmlsIHx8IHNyYyA9PSBuaWwg\newoJCXJldHVybgoJfQoJZHN0LktpbmQgPSBzcmMuS2luZAoJZHN0LlRhZyA9\nIHNyYy5UYWcKCWRzdC5WYWx1ZSA9IHNyYy5WYWx1ZQoJLy8gUmVwbGFjZSBj\nb250ZW50IHdpdGggZGVlcCBjb3B5IGZyb20gc3JjCglpZiBsZW4oc3JjLkNv\nbnRlbnQpID4gMCB7CgkJZHN0LkNvbnRlbnQgPSBtYWtlKFtdKnlhbWwuTm9k\nZSwgbGVuKHNyYy5Db250ZW50KSkKCQlmb3IgaSA6PSByYW5nZSBzcmMuQ29u\ndGVudCB7CgkJCWRzdC5Db250ZW50W2ldID0gZGVlcENvcHlOb2RlKHNyYy5D\nb250ZW50W2ldKQoJCX0KCX0gZWxzZSB7CgkJZHN0LkNvbnRlbnQgPSBuaWwK\nCX0KfQoKZnVuYyByZW9yZGVyU2VxdWVuY2VGb3JNZXJnZShkc3QsIHNyYyAq\neWFtbC5Ob2RlKSB7CglpZiBkc3QgPT0gbmlsIHx8IHNyYyA9PSBuaWwgewoJ\nCXJldHVybgoJfQoJaWYgbGVuKGRzdC5Db250ZW50KSA9PSAwIHsKCQlyZXR1\ncm4KCX0KCWlmIGxlbihzcmMuQ29udGVudCkgPT0gMCB7CgkJcmV0dXJuCgl9\nCglvcmlnaW5hbCA6PSBhcHBlbmQoW10qeWFtbC5Ob2RlKG5pbCksIGRzdC5D\nb250ZW50Li4uKQoJdXNlZCA6PSBtYWtlKFtdYm9vbCwgbGVuKG9yaWdpbmFs\nKSkKCW9yZGVyZWQgOj0gbWFrZShbXSp5YW1sLk5vZGUsIGxlbihzcmMuQ29u\ndGVudCkpCglmb3IgaSA6PSByYW5nZSBzcmMuQ29udGVudCB7CgkJaWYgaWR4\nIDo9IG1hdGNoU2VxdWVuY2VFbGVtZW50KG9yaWdpbmFsLCB1c2VkLCBzcmMu\nQ29udGVudFtpXSk7IGlkeCA+PSAwIHsKCQkJb3JkZXJlZFtpXSA9IG9yaWdp\nbmFsW2lkeF0KCQkJdXNlZFtpZHhdID0gdHJ1ZQoJCX0KCX0KCWRzdC5Db250\nZW50ID0gb3JkZXJlZAp9CgpmdW5jIG1hdGNoU2VxdWVuY2VFbGVtZW50KG9y\naWdpbmFsIFtdKnlhbWwuTm9kZSwgdXNlZCBbXWJvb2wsIHRhcmdldCAqeWFt\nbC5Ob2RlKSBpbnQgewoJaWYgdGFyZ2V0ID09IG5pbCB7CgkJcmV0dXJuIC0x\nCgl9Cglzd2l0Y2ggdGFyZ2V0LktpbmQgewoJY2FzZSB5YW1sLk1hcHBpbmdO\nb2RlOgoJCWlkIDo9IHNlcXVlbmNlRWxlbWVudElkZW50aXR5KHRhcmdldCkK\nCQlpZiBpZCAhPSAiIiB7CgkJCWZvciBpIDo9IHJhbmdlIG9yaWdpbmFsIHsK\nCQkJCWlmIHVzZWRbaV0gfHwgb3JpZ2luYWxbaV0gPT0gbmlsIHx8IG9yaWdp\nbmFsW2ldLktpbmQgIT0geWFtbC5NYXBwaW5nTm9kZSB7CgkJCQkJY29udGlu\ndWUKCQkJCX0KCQkJCWlmIHNlcXVlbmNlRWxlbWVudElkZW50aXR5KG9yaWdp\nbmFsW2ldKSA9PSBpZCB7CgkJCQkJcmV0dXJuIGkKCQkJCX0KCQkJfQoJCX0K\nCWNhc2UgeWFtbC5TY2FsYXJOb2RlOgoJCXZhbCA6PSBzdHJpbmdzLlRyaW1T\ncGFjZSh0YXJnZXQuVmFsdWUpCgkJaWYgdmFsICE9ICIiIHsKCQkJZm9yIGkg\nOj0gcmFuZ2Ugb3JpZ2luYWwgewoJCQkJaWYgdXNlZFtpXSB8fCBvcmlnaW5h\nbFtpXSA9PSBuaWwgfHwgb3JpZ2luYWxbaV0uS2luZCAhPSB5YW1sLlNjYWxh\nck5vZGUgewoJCQkJCWNvbnRpbnVlCgkJCQl9CgkJCQlpZiBzdHJpbmdzLlRy\naW1TcGFjZShvcmlnaW5hbFtpXS5WYWx1ZSkgPT0gdmFsIHsKCQkJCQlyZXR1\ncm4gaQoJCQkJfQoJCQl9CgkJfQoJZGVmYXVsdDoKCX0KCS8vIEZhbGxiYWNr\nIHRvIHN0cnVjdHVyYWwgZXF1YWxpdHkgdG8gcHJlc2VydmUgbm9kZXMgbGFj\na2luZyBleHBsaWNpdCBpZGVudGlmaWVycy4KCWZvciBpIDo9IHJhbmdlIG9y\naWdpbmFsIHsKCQlpZiB1c2VkW2ldIHx8IG9yaWdpbmFsW2ldID09IG5pbCB7\nCgkJCWNvbnRpbnVlCgkJfQoJCWlmIG5vZGVzU3RydWN0dXJhbGx5RXF1YWwo\nb3JpZ2luYWxbaV0sIHRhcmdldCkgewoJCQlyZXR1cm4gaQoJCX0KCX0KCXJl\ndHVybiAtMQp9CgpmdW5jIHNlcXVlbmNlRWxlbWVudElkZW50aXR5KG5vZGUg\nKnlhbWwuTm9kZSkgc3RyaW5nIHsKCWlmIG5vZGUgPT0gbmlsIHx8IG5vZGUu\nS2luZCAhPSB5YW1sLk1hcHBpbmdOb2RlIHsKCQlyZXR1cm4gIiIKCX0KCWlk\nZW50aXR5S2V5cyA6PSBbXXN0cmluZ3siaWQiLCAibmFtZSIsICJhbGlhcyIs\nICJhcGkta2V5IiwgImFwaV9rZXkiLCAiYXBpa2V5IiwgImtleSIsICJwcm92\naWRlciIsICJtb2RlbCJ9Cglmb3IgXywgayA6PSByYW5nZSBpZGVudGl0eUtl\neXMgewoJCWlmIHYgOj0gbWFwcGluZ1NjYWxhclZhbHVlKG5vZGUsIGspOyB2\nICE9ICIiIHsKCQkJcmV0dXJuIGsgKyAiPSIgKyB2CgkJfQoJfQoJZm9yIGkg\nOj0gMDsgaSsxIDwgbGVuKG5vZGUuQ29udGVudCk7IGkgKz0gMiB7CgkJa2V5\nTm9kZSA6PSBub2RlLkNvbnRlbnRbaV0KCQl2YWxOb2RlIDo9IG5vZGUuQ29u\ndGVudFtpKzFdCgkJaWYga2V5Tm9kZSA9PSBuaWwgfHwgdmFsTm9kZSA9PSBu\naWwgfHwgdmFsTm9kZS5LaW5kICE9IHlhbWwuU2NhbGFyTm9kZSB7CgkJCWNv\nbnRpbnVlCgkJfQoJCXZhbCA6PSBzdHJpbmdzLlRyaW1TcGFjZSh2YWxOb2Rl\nLlZhbHVlKQoJCWlmIHZhbCAhPSAiIiB7CgkJCXJldHVybiBzdHJpbmdzLlRv\nTG93ZXIoc3RyaW5ncy5UcmltU3BhY2Uoa2V5Tm9kZS5WYWx1ZSkpICsgIj0i\nICsgdmFsCgkJfQoJfQoJcmV0dXJuICIiCn0KCmZ1bmMgbWFwcGluZ1NjYWxh\nclZhbHVlKG5vZGUgKnlhbWwuTm9kZSwga2V5IHN0cmluZykgc3RyaW5nIHsK\nCWlmIG5vZGUgPT0gbmlsIHx8IG5vZGUuS2luZCAhPSB5YW1sLk1hcHBpbmdO\nb2RlIHsKCQlyZXR1cm4gIiIKCX0KCWxvd2VyS2V5IDo9IHN0cmluZ3MuVG9M\nb3dlcihrZXkpCglmb3IgaSA6PSAwOyBpKzEgPCBsZW4obm9kZS5Db250ZW50\nKTsgaSArPSAyIHsKCQlrZXlOb2RlIDo9IG5vZGUuQ29udGVudFtpXQoJCXZh\nbE5vZGUgOj0gbm9kZS5Db250ZW50W2krMV0KCQlpZiBrZXlOb2RlID09IG5p\nbCB8fCB2YWxOb2RlID09IG5pbCB8fCB2YWxOb2RlLktpbmQgIT0geWFtbC5T\nY2FsYXJOb2RlIHsKCQkJY29udGludWUKCQl9CgkJaWYgc3RyaW5ncy5Ub0xv\nd2VyKHN0cmluZ3MuVHJpbVNwYWNlKGtleU5vZGUuVmFsdWUpKSA9PSBsb3dl\ncktleSB7CgkJCXJldHVybiBzdHJpbmdzLlRyaW1TcGFjZSh2YWxOb2RlLlZh\nbHVlKQoJCX0KCX0KCXJldHVybiAiIgp9CgpmdW5jIG5vZGVzU3RydWN0dXJh\nbGx5RXF1YWwoYSwgYiAqeWFtbC5Ob2RlKSBib29sIHsKCWlmIGEgPT0gbmls\nIHx8IGIgPT0gbmlsIHsKCQlyZXR1cm4gYSA9PSBiCgl9CglpZiBhLktpbmQg\nIT0gYi5LaW5kIHsKCQlyZXR1cm4gZmFsc2UKCX0KCXN3aXRjaCBhLktpbmQg\newoJY2FzZSB5YW1sLk1hcHBpbmdOb2RlOgoJCWlmIGxlbihhLkNvbnRlbnQp\nICE9IGxlbihiLkNvbnRlbnQpIHsKCQkJcmV0dXJuIGZhbHNlCgkJfQoJCWZv\nciBpIDo9IDA7IGkrMSA8IGxlbihhLkNvbnRlbnQpOyBpICs9IDIgewoJCQlp\nZiAhbm9kZXNTdHJ1Y3R1cmFsbHlFcXVhbChhLkNvbnRlbnRbaV0sIGIuQ29u\ndGVudFtpXSkgewoJCQkJcmV0dXJuIGZhbHNlCgkJCX0KCQkJaWYgIW5vZGVz\nU3RydWN0dXJhbGx5RXF1YWwoYS5Db250ZW50W2krMV0sIGIuQ29udGVudFtp\nKzFdKSB7CgkJCQlyZXR1cm4gZmFsc2UKCQkJfQoJCX0KCQlyZXR1cm4gdHJ1\nZQoJY2FzZSB5YW1sLlNlcXVlbmNlTm9kZToKCQlpZiBsZW4oYS5Db250ZW50\nKSAhPSBsZW4oYi5Db250ZW50KSB7CgkJCXJldHVybiBmYWxzZQoJCX0KCQlm\nb3IgaSA6PSByYW5nZSBhLkNvbnRlbnQgewoJCQlpZiAhbm9kZXNTdHJ1Y3R1\ncmFsbHlFcXVhbChhLkNvbnRlbnRbaV0sIGIuQ29udGVudFtpXSkgewoJCQkJ\ncmV0dXJuIGZhbHNlCgkJCX0KCQl9CgkJcmV0dXJuIHRydWUKCWNhc2UgeWFt\nbC5TY2FsYXJOb2RlOgoJCXJldHVybiBzdHJpbmdzLlRyaW1TcGFjZShhLlZh\nbHVlKSA9PSBzdHJpbmdzLlRyaW1TcGFjZShiLlZhbHVlKQoJY2FzZSB5YW1s\nLkFsaWFzTm9kZToKCQlyZXR1cm4gbm9kZXNTdHJ1Y3R1cmFsbHlFcXVhbChh\nLkFsaWFzLCBiLkFsaWFzKQoJZGVmYXVsdDoKCQlyZXR1cm4gc3RyaW5ncy5U\ncmltU3BhY2UoYS5WYWx1ZSkgPT0gc3RyaW5ncy5UcmltU3BhY2UoYi5WYWx1\nZSkKCX0KfQoKZnVuYyByZW1vdmVNYXBLZXkobWFwTm9kZSAqeWFtbC5Ob2Rl\nLCBrZXkgc3RyaW5nKSB7CglpZiBtYXBOb2RlID09IG5pbCB8fCBtYXBOb2Rl\nLktpbmQgIT0geWFtbC5NYXBwaW5nTm9kZSB8fCBrZXkgPT0gIiIgewoJCXJl\ndHVybgoJfQoJZm9yIGkgOj0gMDsgaSsxIDwgbGVuKG1hcE5vZGUuQ29udGVu\ndCk7IGkgKz0gMiB7CgkJaWYgbWFwTm9kZS5Db250ZW50W2ldICE9IG5pbCAm\nJiBtYXBOb2RlLkNvbnRlbnRbaV0uVmFsdWUgPT0ga2V5IHsKCQkJbWFwTm9k\nZS5Db250ZW50ID0gYXBwZW5kKG1hcE5vZGUuQ29udGVudFs6aV0sIG1hcE5v\nZGUuQ29udGVudFtpKzI6XS4uLikKCQkJcmV0dXJuCgkJfQoJfQp9CgpmdW5j\nIHBydW5lTWFwcGluZ1RvR2VuZXJhdGVkS2V5cyhkc3RSb290LCBzcmNSb290\nICp5YW1sLk5vZGUsIGtleSBzdHJpbmcpIHsKCWlmIGtleSA9PSAiIiB8fCBk\nc3RSb290ID09IG5pbCB8fCBzcmNSb290ID09IG5pbCB7CgkJcmV0dXJuCgl9\nCglpZiBkc3RSb290LktpbmQgIT0geWFtbC5NYXBwaW5nTm9kZSB8fCBzcmNS\nb290LktpbmQgIT0geWFtbC5NYXBwaW5nTm9kZSB7CgkJcmV0dXJuCgl9Cglk\nc3RJZHggOj0gZmluZE1hcEtleUluZGV4KGRzdFJvb3QsIGtleSkKCWlmIGRz\ndElkeCA8IDAgfHwgZHN0SWR4KzEgPj0gbGVuKGRzdFJvb3QuQ29udGVudCkg\newoJCXJldHVybgoJfQoJc3JjSWR4IDo9IGZpbmRNYXBLZXlJbmRleChzcmNS\nb290LCBrZXkpCglpZiBzcmNJZHggPCAwIHsKCQlyZW1vdmVNYXBLZXkoZHN0\nUm9vdCwga2V5KQoJCXJldHVybgoJfQoJaWYgc3JjSWR4KzEgPj0gbGVuKHNy\nY1Jvb3QuQ29udGVudCkgewoJCXJldHVybgoJfQoJc3JjVmFsIDo9IHNyY1Jv\nb3QuQ29udGVudFtzcmNJZHgrMV0KCWRzdFZhbCA6PSBkc3RSb290LkNvbnRl\nbnRbZHN0SWR4KzFdCglpZiBzcmNWYWwgPT0gbmlsIHsKCQlkc3RSb290LkNv\nbnRlbnRbZHN0SWR4KzFdID0gbmlsCgkJcmV0dXJuCgl9CglpZiBzcmNWYWwu\nS2luZCAhPSB5YW1sLk1hcHBpbmdOb2RlIHsKCQlkc3RSb290LkNvbnRlbnRb\nZHN0SWR4KzFdID0gZGVlcENvcHlOb2RlKHNyY1ZhbCkKCQlyZXR1cm4KCX0K\nCWlmIGRzdFZhbCA9PSBuaWwgfHwgZHN0VmFsLktpbmQgIT0geWFtbC5NYXBw\naW5nTm9kZSB7CgkJZHN0Um9vdC5Db250ZW50W2RzdElkeCsxXSA9IGRlZXBD\nb3B5Tm9kZShzcmNWYWwpCgkJcmV0dXJuCgl9CglwcnVuZU1pc3NpbmdNYXBL\nZXlzKGRzdFZhbCwgc3JjVmFsKQp9CgpmdW5jIHBydW5lTWlzc2luZ01hcEtl\neXMoZHN0TWFwLCBzcmNNYXAgKnlhbWwuTm9kZSkgewoJaWYgZHN0TWFwID09\nIG5pbCB8fCBzcmNNYXAgPT0gbmlsIHx8IGRzdE1hcC5LaW5kICE9IHlhbWwu\nTWFwcGluZ05vZGUgfHwgc3JjTWFwLktpbmQgIT0geWFtbC5NYXBwaW5nTm9k\nZSB7CgkJcmV0dXJuCgl9CglrZWVwIDo9IG1ha2UobWFwW3N0cmluZ11zdHJ1\nY3R7fSwgbGVuKHNyY01hcC5Db250ZW50KS8yKQoJZm9yIGkgOj0gMDsgaSsx\nIDwgbGVuKHNyY01hcC5Db250ZW50KTsgaSArPSAyIHsKCQlrZXlOb2RlIDo9\nIHNyY01hcC5Db250ZW50W2ldCgkJaWYga2V5Tm9kZSA9PSBuaWwgewoJCQlj\nb250aW51ZQoJCX0KCQlrZXkgOj0gc3RyaW5ncy5UcmltU3BhY2Uoa2V5Tm9k\nZS5WYWx1ZSkKCQlpZiBrZXkgPT0gIiIgewoJCQljb250aW51ZQoJCX0KCQlr\nZWVwW2tleV0gPSBzdHJ1Y3R7fXt9Cgl9Cglmb3IgaSA6PSAwOyBpKzEgPCBs\nZW4oZHN0TWFwLkNvbnRlbnQpOyB7CgkJa2V5Tm9kZSA6PSBkc3RNYXAuQ29u\ndGVudFtpXQoJCWlmIGtleU5vZGUgPT0gbmlsIHsKCQkJaSArPSAyCgkJCWNv\nbnRpbnVlCgkJfQoJCWtleSA6PSBzdHJpbmdzLlRyaW1TcGFjZShrZXlOb2Rl\nLlZhbHVlKQoJCWlmIF8sIG9rIDo9IGtlZXBba2V5XTsgIW9rIHsKCQkJZHN0\nTWFwLkNvbnRlbnQgPSBhcHBlbmQoZHN0TWFwLkNvbnRlbnRbOmldLCBkc3RN\nYXAuQ29udGVudFtpKzI6XS4uLikKCQkJY29udGludWUKCQl9CgkJaSArPSAy\nCgl9Cn0KCi8vIG5vcm1hbGl6ZUNvbGxlY3Rpb25Ob2RlU3R5bGVzIGZvcmNl\ncyBZQU1MIGNvbGxlY3Rpb25zIHRvIHVzZSBibG9jayBub3RhdGlvbiwga2Vl\ncGluZwovLyBsaXN0cyBhbmQgbWFwcyByZWFkYWJsZS4gRW1wdHkgc2VxdWVu\nY2VzIHJldGFpbiBmbG93IHN0eWxlIChbXSkgc28gZW1wdHkgbGlzdCBtYXJr\nZXJzCi8vIHJlbWFpbiBjb21wYWN0LgpmdW5jIG5vcm1hbGl6ZUNvbGxlY3Rp\nb25Ob2RlU3R5bGVzKG5vZGUgKnlhbWwuTm9kZSkgewoJaWYgbm9kZSA9PSBu\naWwgewoJCXJldHVybgoJfQoJc3dpdGNoIG5vZGUuS2luZCB7CgljYXNlIHlh\nbWwuTWFwcGluZ05vZGU6CgkJbm9kZS5TdHlsZSA9IDAKCQlmb3IgaSA6PSBy\nYW5nZSBub2RlLkNvbnRlbnQgewoJCQlub3JtYWxpemVDb2xsZWN0aW9uTm9k\nZVN0eWxlcyhub2RlLkNvbnRlbnRbaV0pCgkJfQoJY2FzZSB5YW1sLlNlcXVl\nbmNlTm9kZToKCQlpZiBsZW4obm9kZS5Db250ZW50KSA9PSAwIHsKCQkJbm9k\nZS5TdHlsZSA9IHlhbWwuRmxvd1N0eWxlCgkJfSBlbHNlIHsKCQkJbm9kZS5T\ndHlsZSA9IDAKCQl9CgkJZm9yIGkgOj0gcmFuZ2Ugbm9kZS5Db250ZW50IHsK\nCQkJbm9ybWFsaXplQ29sbGVjdGlvbk5vZGVTdHlsZXMobm9kZS5Db250ZW50\nW2ldKQoJCX0KCWRlZmF1bHQ6CgkJLy8gU2NhbGFycyBrZWVwIHRoZWlyIGV4\naXN0aW5nIHN0eWxlIHRvIHByZXNlcnZlIHF1b3RpbmcKCX0KfQoKLy8gTGVn\nYWN5IG1pZ3JhdGlvbiBoZWxwZXJzIChtb3ZlIGRlcHJlY2F0ZWQgY29uZmln\nIGtleXMgaW50byBzdHJ1Y3R1cmVkIGZpZWxkcykuCnR5cGUgbGVnYWN5Q29u\nZmlnRGF0YSBzdHJ1Y3QgewoJTGVnYWN5R2VtaW5pS2V5cyAgICAgIFtdc3Ry\naW5nICAgICAgICAgICAgICAgICAgICBgeWFtbDoiZ2VuZXJhdGl2ZS1sYW5n\ndWFnZS1hcGkta2V5ImAKCU9wZW5BSUNvbXBhdCAgICAgICAgICBbXWxlZ2Fj\neU9wZW5BSUNvbXBhdGliaWxpdHkgYHlhbWw6Im9wZW5haS1jb21wYXRpYmls\naXR5ImAKCUFtcFVwc3RyZWFtVVJMICAgICAgICBzdHJpbmcgICAgICAgICAg\nICAgICAgICAgICAgYHlhbWw6ImFtcC11cHN0cmVhbS11cmwiYAoJQW1wVXBz\ndHJlYW1BUElLZXkgICAgIHN0cmluZyAgICAgICAgICAgICAgICAgICAgICBg\neWFtbDoiYW1wLXVwc3RyZWFtLWFwaS1rZXkiYAoJQW1wUmVzdHJpY3RNYW5h\nZ2VtZW50ICpib29sICAgICAgICAgICAgICAgICAgICAgICBgeWFtbDoiYW1w\nLXJlc3RyaWN0LW1hbmFnZW1lbnQtdG8tbG9jYWxob3N0ImAKCUFtcE1vZGVs\nTWFwcGluZ3MgICAgICBbXUFtcE1vZGVsTWFwcGluZyAgICAgICAgICAgYHlh\nbWw6ImFtcC1tb2RlbC1tYXBwaW5ncyJgCn0KCnR5cGUgbGVnYWN5T3BlbkFJ\nQ29tcGF0aWJpbGl0eSBzdHJ1Y3QgewoJTmFtZSAgICBzdHJpbmcgICBgeWFt\nbDoibmFtZSJgCglCYXNlVVJMIHN0cmluZyAgIGB5YW1sOiJiYXNlLXVybCJg\nCglBUElLZXlzIFtdc3RyaW5nIGB5YW1sOiJhcGkta2V5cyJgCn0KCmZ1bmMg\nKGNmZyAqQ29uZmlnKSBtaWdyYXRlTGVnYWN5R2VtaW5pS2V5cyhsZWdhY3kg\nW11zdHJpbmcpIGJvb2wgewoJaWYgY2ZnID09IG5pbCB8fCBsZW4obGVnYWN5\nKSA9PSAwIHsKCQlyZXR1cm4gZmFsc2UKCX0KCWNoYW5nZWQgOj0gZmFsc2UK\nCXNlZW4gOj0gbWFrZShtYXBbc3RyaW5nXXN0cnVjdHt9LCBsZW4oY2ZnLkdl\nbWluaUtleSkpCglmb3IgaSA6PSByYW5nZSBjZmcuR2VtaW5pS2V5IHsKCQlr\nZXkgOj0gc3RyaW5ncy5UcmltU3BhY2UoY2ZnLkdlbWluaUtleVtpXS5BUElL\nZXkpCgkJaWYga2V5ID09ICIiIHsKCQkJY29udGludWUKCQl9CgkJc2Vlbltr\nZXldID0gc3RydWN0e317fQoJfQoJZm9yIF8sIHJhdyA6PSByYW5nZSBsZWdh\nY3kgewoJCWtleSA6PSBzdHJpbmdzLlRyaW1TcGFjZShyYXcpCgkJaWYga2V5\nID09ICIiIHsKCQkJY29udGludWUKCQl9CgkJaWYgXywgZXhpc3RzIDo9IHNl\nZW5ba2V5XTsgZXhpc3RzIHsKCQkJY29udGludWUKCQl9CgkJY2ZnLkdlbWlu\naUtleSA9IGFwcGVuZChjZmcuR2VtaW5pS2V5LCBHZW1pbmlLZXl7QVBJS2V5\nOiBrZXl9KQoJCXNlZW5ba2V5XSA9IHN0cnVjdHt9e30KCQljaGFuZ2VkID0g\ndHJ1ZQoJfQoJcmV0dXJuIGNoYW5nZWQKfQoKZnVuYyAoY2ZnICpDb25maWcp\nIG1pZ3JhdGVMZWdhY3lPcGVuQUlDb21wYXRpYmlsaXR5S2V5cyhsZWdhY3kg\nW11sZWdhY3lPcGVuQUlDb21wYXRpYmlsaXR5KSBib29sIHsKCWlmIGNmZyA9\nPSBuaWwgfHwgbGVuKGNmZy5PcGVuQUlDb21wYXRpYmlsaXR5KSA9PSAwIHx8\nIGxlbihsZWdhY3kpID09IDAgewoJCXJldHVybiBmYWxzZQoJfQoJY2hhbmdl\nZCA6PSBmYWxzZQoJZm9yIF8sIGxlZ2FjeUVudHJ5IDo9IHJhbmdlIGxlZ2Fj\neSB7CgkJaWYgbGVuKGxlZ2FjeUVudHJ5LkFQSUtleXMpID09IDAgewoJCQlj\nb250aW51ZQoJCX0KCQl0YXJnZXQgOj0gZmluZE9wZW5BSUNvbXBhdFRhcmdl\ndChjZmcuT3BlbkFJQ29tcGF0aWJpbGl0eSwgbGVnYWN5RW50cnkuTmFtZSwg\nbGVnYWN5RW50cnkuQmFzZVVSTCkKCQlpZiB0YXJnZXQgPT0gbmlsIHsKCQkJ\nY29udGludWUKCQl9CgkJaWYgbWVyZ2VMZWdhY3lPcGVuQUlDb21wYXRBUElL\nZXlzKHRhcmdldCwgbGVnYWN5RW50cnkuQVBJS2V5cykgewoJCQljaGFuZ2Vk\nID0gdHJ1ZQoJCX0KCX0KCXJldHVybiBjaGFuZ2VkCn0KCmZ1bmMgbWVyZ2VM\nZWdhY3lPcGVuQUlDb21wYXRBUElLZXlzKGVudHJ5ICpPcGVuQUlDb21wYXRp\nYmlsaXR5LCBrZXlzIFtdc3RyaW5nKSBib29sIHsKCWlmIGVudHJ5ID09IG5p\nbCB8fCBsZW4oa2V5cykgPT0gMCB7CgkJcmV0dXJuIGZhbHNlCgl9CgljaGFu\nZ2VkIDo9IGZhbHNlCglleGlzdGluZyA6PSBtYWtlKG1hcFtzdHJpbmddc3Ry\ndWN0e30sIGxlbihlbnRyeS5BUElLZXlFbnRyaWVzKSkKCWZvciBpIDo9IHJh\nbmdlIGVudHJ5LkFQSUtleUVudHJpZXMgewoJCWtleSA6PSBzdHJpbmdzLlRy\naW1TcGFjZShlbnRyeS5BUElLZXlFbnRyaWVzW2ldLkFQSUtleSkKCQlpZiBr\nZXkgPT0gIiIgewoJCQljb250aW51ZQoJCX0KCQlleGlzdGluZ1trZXldID0g\nc3RydWN0e317fQoJfQoJZm9yIF8sIHJhdyA6PSByYW5nZSBrZXlzIHsKCQlr\nZXkgOj0gc3RyaW5ncy5UcmltU3BhY2UocmF3KQoJCWlmIGtleSA9PSAiIiB7\nCgkJCWNvbnRpbnVlCgkJfQoJCWlmIF8sIG9rIDo9IGV4aXN0aW5nW2tleV07\nIG9rIHsKCQkJY29udGludWUKCQl9CgkJZW50cnkuQVBJS2V5RW50cmllcyA9\nIGFwcGVuZChlbnRyeS5BUElLZXlFbnRyaWVzLCBPcGVuQUlDb21wYXRpYmls\naXR5QVBJS2V5e0FQSUtleToga2V5fSkKCQlleGlzdGluZ1trZXldID0gc3Ry\ndWN0e317fQoJCWNoYW5nZWQgPSB0cnVlCgl9CglyZXR1cm4gY2hhbmdlZAp9\nCgpmdW5jIGZpbmRPcGVuQUlDb21wYXRUYXJnZXQoZW50cmllcyBbXU9wZW5B\nSUNvbXBhdGliaWxpdHksIGxlZ2FjeU5hbWUsIGxlZ2FjeUJhc2Ugc3RyaW5n\nKSAqT3BlbkFJQ29tcGF0aWJpbGl0eSB7CgluYW1lS2V5IDo9IHN0cmluZ3Mu\nVG9Mb3dlcihzdHJpbmdzLlRyaW1TcGFjZShsZWdhY3lOYW1lKSkKCWJhc2VL\nZXkgOj0gc3RyaW5ncy5Ub0xvd2VyKHN0cmluZ3MuVHJpbVNwYWNlKGxlZ2Fj\neUJhc2UpKQoJaWYgbmFtZUtleSAhPSAiIiAmJiBiYXNlS2V5ICE9ICIiIHsK\nCQlmb3IgaSA6PSByYW5nZSBlbnRyaWVzIHsKCQkJaWYgc3RyaW5ncy5Ub0xv\nd2VyKHN0cmluZ3MuVHJpbVNwYWNlKGVudHJpZXNbaV0uTmFtZSkpID09IG5h\nbWVLZXkgJiYKCQkJCXN0cmluZ3MuVG9Mb3dlcihzdHJpbmdzLlRyaW1TcGFj\nZShlbnRyaWVzW2ldLkJhc2VVUkwpKSA9PSBiYXNlS2V5IHsKCQkJCXJldHVy\nbiAmZW50cmllc1tpXQoJCQl9CgkJfQoJfQoJaWYgYmFzZUtleSAhPSAiIiB7\nCgkJZm9yIGkgOj0gcmFuZ2UgZW50cmllcyB7CgkJCWlmIHN0cmluZ3MuVG9M\nb3dlcihzdHJpbmdzLlRyaW1TcGFjZShlbnRyaWVzW2ldLkJhc2VVUkwpKSA9\nPSBiYXNlS2V5IHsKCQkJCXJldHVybiAmZW50cmllc1tpXQoJCQl9CgkJfQoJ\nfQoJaWYgbmFtZUtleSAhPSAiIiB7CgkJZm9yIGkgOj0gcmFuZ2UgZW50cmll\ncyB7CgkJCWlmIHN0cmluZ3MuVG9Mb3dlcihzdHJpbmdzLlRyaW1TcGFjZShl\nbnRyaWVzW2ldLk5hbWUpKSA9PSBuYW1lS2V5IHsKCQkJCXJldHVybiAmZW50\ncmllc1tpXQoJCQl9CgkJfQoJfQoJcmV0dXJuIG5pbAp9CgpmdW5jIChjZmcg\nKkNvbmZpZykgbWlncmF0ZUxlZ2FjeUFtcENvbmZpZyhsZWdhY3kgKmxlZ2Fj\neUNvbmZpZ0RhdGEpIGJvb2wgewoJaWYgY2ZnID09IG5pbCB8fCBsZWdhY3kg\nPT0gbmlsIHsKCQlyZXR1cm4gZmFsc2UKCX0KCWNoYW5nZWQgOj0gZmFsc2UK\nCWlmIGNmZy5BbXBDb2RlLlVwc3RyZWFtVVJMID09ICIiIHsKCQlpZiB2YWwg\nOj0gc3RyaW5ncy5UcmltU3BhY2UobGVnYWN5LkFtcFVwc3RyZWFtVVJMKTsg\ndmFsICE9ICIiIHsKCQkJY2ZnLkFtcENvZGUuVXBzdHJlYW1VUkwgPSB2YWwK\nCQkJY2hhbmdlZCA9IHRydWUKCQl9Cgl9CglpZiBjZmcuQW1wQ29kZS5VcHN0\ncmVhbUFQSUtleSA9PSAiIiB7CgkJaWYgdmFsIDo9IHN0cmluZ3MuVHJpbVNw\nYWNlKGxlZ2FjeS5BbXBVcHN0cmVhbUFQSUtleSk7IHZhbCAhPSAiIiB7CgkJ\nCWNmZy5BbXBDb2RlLlVwc3RyZWFtQVBJS2V5ID0gdmFsCgkJCWNoYW5nZWQg\nPSB0cnVlCgkJfQoJfQoJaWYgbGVnYWN5LkFtcFJlc3RyaWN0TWFuYWdlbWVu\ndCAhPSBuaWwgewoJCWNmZy5BbXBDb2RlLlJlc3RyaWN0TWFuYWdlbWVudFRv\nTG9jYWxob3N0ID0gKmxlZ2FjeS5BbXBSZXN0cmljdE1hbmFnZW1lbnQKCQlj\naGFuZ2VkID0gdHJ1ZQoJfQoJaWYgbGVuKGNmZy5BbXBDb2RlLk1vZGVsTWFw\ncGluZ3MpID09IDAgJiYgbGVuKGxlZ2FjeS5BbXBNb2RlbE1hcHBpbmdzKSA+\nIDAgewoJCWNmZy5BbXBDb2RlLk1vZGVsTWFwcGluZ3MgPSBhcHBlbmQoW11B\nbXBNb2RlbE1hcHBpbmcobmlsKSwgbGVnYWN5LkFtcE1vZGVsTWFwcGluZ3Mu\nLi4pCgkJY2hhbmdlZCA9IHRydWUKCX0KCXJldHVybiBjaGFuZ2VkCn0KCmZ1\nbmMgcmVtb3ZlTGVnYWN5T3BlbkFJQ29tcGF0QVBJS2V5cyhyb290ICp5YW1s\nLk5vZGUpIHsKCWlmIHJvb3QgPT0gbmlsIHx8IHJvb3QuS2luZCAhPSB5YW1s\nLk1hcHBpbmdOb2RlIHsKCQlyZXR1cm4KCX0KCWlkeCA6PSBmaW5kTWFwS2V5\nSW5kZXgocm9vdCwgIm9wZW5haS1jb21wYXRpYmlsaXR5IikKCWlmIGlkeCA8\nIDAgfHwgaWR4KzEgPj0gbGVuKHJvb3QuQ29udGVudCkgewoJCXJldHVybgoJ\nfQoJc2VxIDo9IHJvb3QuQ29udGVudFtpZHgrMV0KCWlmIHNlcSA9PSBuaWwg\nfHwgc2VxLktpbmQgIT0geWFtbC5TZXF1ZW5jZU5vZGUgewoJCXJldHVybgoJ\nfQoJZm9yIGkgOj0gcmFuZ2Ugc2VxLkNvbnRlbnQgewoJCWlmIHNlcS5Db250\nZW50W2ldICE9IG5pbCAmJiBzZXEuQ29udGVudFtpXS5LaW5kID09IHlhbWwu\nTWFwcGluZ05vZGUgewoJCQlyZW1vdmVNYXBLZXkoc2VxLkNvbnRlbnRbaV0s\nICJhcGkta2V5cyIpCgkJfQoJfQp9CgpmdW5jIHJlbW92ZUxlZ2FjeUFtcEtl\neXMocm9vdCAqeWFtbC5Ob2RlKSB7CglpZiByb290ID09IG5pbCB8fCByb290\nLktpbmQgIT0geWFtbC5NYXBwaW5nTm9kZSB7CgkJcmV0dXJuCgl9CglyZW1v\ndmVNYXBLZXkocm9vdCwgImFtcC11cHN0cmVhbS11cmwiKQoJcmVtb3ZlTWFw\nS2V5KHJvb3QsICJhbXAtdXBzdHJlYW0tYXBpLWtleSIpCglyZW1vdmVNYXBL\nZXkocm9vdCwgImFtcC1yZXN0cmljdC1tYW5hZ2VtZW50LXRvLWxvY2FsaG9z\ndCIpCglyZW1vdmVNYXBLZXkocm9vdCwgImFtcC1tb2RlbC1tYXBwaW5ncyIp\nCn0KCmZ1bmMgcmVtb3ZlTGVnYWN5R2VuZXJhdGl2ZUxhbmd1YWdlS2V5cyhy\nb290ICp5YW1sLk5vZGUpIHsKCWlmIHJvb3QgPT0gbmlsIHx8IHJvb3QuS2lu\nZCAhPSB5YW1sLk1hcHBpbmdOb2RlIHsKCQlyZXR1cm4KCX0KCXJlbW92ZU1h\ncEtleShyb290LCAiZ2VuZXJhdGl2ZS1sYW5ndWFnZS1hcGkta2V5IikKfQoK\nZnVuYyByZW1vdmVMZWdhY3lBdXRoQmxvY2socm9vdCAqeWFtbC5Ob2RlKSB7\nCglpZiByb290ID09IG5pbCB8fCByb290LktpbmQgIT0geWFtbC5NYXBwaW5n\nTm9kZSB7CgkJcmV0dXJuCgl9CglyZW1vdmVNYXBLZXkocm9vdCwgImF1dGgi\nKQp9Cg==\n","encoding":"base64"}
